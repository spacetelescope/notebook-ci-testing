

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>STIS Coronagraphy Visualization Tool (v2) &#8212; HST Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Calstis 2-D CCD Data Reduction" href="../calstis/calstis_2d_ccd.html" />
    <link rel="prev" title="STIS DrizzlePac Tutorial" href="../drizpac_notebook/STIS_DrizzlePac_Tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="HST Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="HST Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    STScI Notebook Repository HQ
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ACS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ACS/README.html">ACS Notebooks</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_findsat_mrt/acs_findsat_mrt_example.html">Satellite trail detection in ACS/WFC data using acstools.findsat_mrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_saturation_trails/acs_saturation_trails.html">ACS Linearity with Saturated Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_cte_forward_model/acs_cte_forward_model_example.html">Pixel-based ACS/WFC CTE Forward Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_subarrays/acs_subarrays.html">ACS Image Reduction for Subarray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_sbc_dark_analysis/acs_sbc_dark_analysis.html">SBC Dark Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_reduction/acs_reduction.html">ACS/WFC Image Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_pixel_area_maps/acs_pixel_area_maps.html">Obtaining Pixel Area Maps for ACS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_polarization_tools/acs_polarization_tools.html">Using ACS Polarization Tools</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../COS/README.html">COS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/Setup/Setup.html">Setting up your computer environment for working with COS data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/DataDl/DataDl.html">Downloading COS Data</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../COS/ViewData/ViewData.html">Viewing COS Data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/AsnFile/AsnFile.html">Modifying or Creating an Association File</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/CalCOS/CalCOS.html">Running the COS Data Pipeline (<code class="docutils literal notranslate"><span class="pre">CalCOS</span></code>)</a></li>






<li class="toctree-l1"><a class="reference internal" href="../../COS/SplitTag/SplitTag.html">Splitting COS Exposures into sub-exposures with <code class="docutils literal notranslate"><span class="pre">splittag</span></code></a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/DayNight/DayNight.html">Filtering out COS Data taken during the Day or Night</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/LSF/LSF.html">Working with the COS Line Spread Function (LSF)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../COS/Extract/Extract.html">Editing the extraction boxes in a spectral extraction file (<code class="docutils literal notranslate"><span class="pre">XTRACTAB</span></code>)</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DrizzlePac</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/README.html">DrizzlePac Jupyter Notebook Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/Initialization/Initialization.html">DrizzlePac Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_to_catalogs/align_to_catalogs.html">Aligning HST images to an absolute reference catalog</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_multiple_visits/align_multiple_visits.html">Optimizing Image Alignment for Multiple HST Visits</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_sparse_fields/align_sparse_fields.html">Aligning Deep Exposures of Sparse Fields</a></li>








<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/drizzle_wfpc2/drizzle_wfpc2.html">Drizzling WFPC2 Images to use a Single Zeropoint</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/mask_satellite/mask_satellite.html">Satellite Trail Masking Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/optimize_image_sampling/optimize_image_sampling.html">Optimizing the Image Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/using_updated_astrometry_solutions/using_updated_astrometry_solutions.html">Using updated astrometry solutions</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NICMOS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NICMOS/nicmos_unit_conversion/nicmos_unit_conversion.html">Programmatic Replacements for NICMOS Units Conversion Form</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STIS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">STIS-Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cross-correlation/cross-correlation.html">Correcting for Missing Wavecals with Cross-Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_ccd_darks/custom_ccd_darks.html">Custom CCD Darks <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../drizpac_notebook/STIS_DrizzlePac_Tutorial.html">STIS DrizzlePac Tutorial <a class="tocSkip"></a></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">STIS Coronagraphy Visualization Tool (v2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calstis/calstis_2d_ccd.html">Calstis 2-D CCD Data Reduction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../target_acquisition/target_acquisition.html">Evaluating STIS Target Acquisitions <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../view_data/view_data.html">Viewing STIS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extraction/1D_Extraction.html">1D Spectra Extraction <a class="tocSkip"></a></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">WFC3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/README.html">WFC3Library</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Casjobs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../casjobs/HCV_casjobs_demo.html">Hubble Catalog of Variables Notebook (CasJobs version)</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/hst_notebooks/blob/main/notebooks/STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>STIS Coronagraphy Visualization Tool (v2)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-stis-coronagraphy-planning-and-occulters">Introduction: STIS Coronagraphy Planning and Occulters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#guide-to-usage">Guide to Usage</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-additional-notes">Some additional notes:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-the-primary-function-show-orients">Set up the primary function, <em>show_orients</em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-star-with-a-companion-visible">Example #1: Star with a companion (visible)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-the-example-below-the-properties-of-the-point-source-companion-are-defined-in-line-in-the-function-call-directly-the-resulting-image-shows-the-following-features">In the example below, the properties of the point-source companion are defined in-line in the function call directly. The resulting image shows the following features:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-star-with-a-companion-obscured">Example #2: Star with a companion (obscured)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-example-the-set-up-is-the-same-as-in-example-1-and-the-only-changed-parameter-is-the-orient-angle-resulting-in-an-obscured-companion-behind-the-bar10-occulter">In this example, the set-up is the same as in Example #1 and the only changed parameter is the ORIENT angle, resulting in an obscured companion behind the BAR10 occulter.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-star-with-a-simple-circumstellar-disk">Example #3: Star with a simple circumstellar disk</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a id=header></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="stis-coronagraphy-visualization-tool-v2">
<h1>STIS Coronagraphy Visualization Tool (v2)<a class="headerlink" href="#stis-coronagraphy-visualization-tool-v2" title="Permalink to this heading">#</a></h1>
<p>Developed by K. Ward-Duong (<a class="reference external" href="mailto:kwduong&#37;&#52;&#48;stsci&#46;edu">kwduong<span>&#64;</span>stsci<span>&#46;</span>edu</a>), last revision 2023-08-29</p>
<section id="introduction-stis-coronagraphy-planning-and-occulters">
<h2>Introduction: STIS Coronagraphy Planning and Occulters<a class="headerlink" href="#introduction-stis-coronagraphy-planning-and-occulters" title="Permalink to this heading">#</a></h2>
<p>Some of the most important steps in planning and preparing coronagraphic observations with STIS involve:</p>
<ul class="simple">
<li><ol class="arabic simple">
<li><p>selecting the appropriate occulter position (from the various supported fiducial apertures, visualized in the figure below on an on-orbit lamp flatfield)</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>determining the appropriate orientation of the observatory to conduct science observations, often at multiple telescope roll angles to provide angular diversity of imaging for the purposes of post-processing.</p></li>
</ol>
</li>
</ul>
<p>Considerations for these decisions include avoiding the locations of the central star’s diffraction spikes relative to any scientific feature(s) of interest, and verifying the true north angle of the CCD detector to understand where a given companion or disk feature might be located.</p>
<p>To this end, the functions and examples in this notebook are meant to be an illustrative guide to visualizing possible aperture+companion+orientation configurations.</p>
<img src="c12_special12.1.png" alt="Positions of STIS supported coronagraphic apertures, including the two WEDGEs and two BARs." style="width: 500px;"/>
<p><span style="font-size: larger; font-weight:bold">Positions of STIS supported coronagraphic apertures, including the two WEDGEs and two BARs. Note that the full STIS field of view is 50” x 50”.</span></p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<p><strong>We will import the following packages:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> for plotting data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> to handle array functions</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Ellipse</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Wedge</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</section>
<section id="guide-to-usage">
<h2>Guide to Usage<a class="headerlink" href="#guide-to-usage" title="Permalink to this heading">#</a></h2>
<p>The purpose of this notebook is to provide a function to visualize the STIS detector orientation for various astrophysical scenes and instrumental/telescope configurations. Examples below include a simple star+companion scene, and a star+disk scene, in order to determine the visibility of the scientific feature of interest relative to the STIS occulter of choice, stellar diffraction spikes, and true north angle.</p>
<p>The function <em>show_orients</em> is used to display images and takes the following keywords:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>inputs
----------------
orients       : (float or list) single ORIENT value or list of values 
aperture      : (str) which STIS occulting aperture position to use. Valid options are:
                        &#39;BAR10&#39;, &#39;BAR5&#39;, &#39;WEDGEA0.6&#39;, &#39;WEDGEA1.0&#39;, &#39;WEDGEA2.0&#39;, &#39;WEDGEB1.0&#39; 
fov           : (float) region of the detector to display, in arcsec                            
feature       : (str) whether to display a point source companion or extended disk (&quot;companion&quot; or &quot;disk&quot;)
featurepa     : (float) position angle of feature of interest in degrees E of N 
postarg       : (tuple) x, y offset from the fiducial aperture in arcsec. Default is no offset (0,0)
avoidspikes   : (float, default=20) &#39;avoidance&#39; region to avoid stellar diffraction spikes    

optional arguments
-----------------
featuresep    : (float) separation of companion
disk_height   : (float) semiminor axis of the disk in arcsec
disk_width    : (float) semimajor axis of the disk in arcsec
</pre></div>
</div>
<section id="some-additional-notes">
<h3>Some additional notes:<a class="headerlink" href="#some-additional-notes" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>When visualizing a companion, the <code class="docutils literal notranslate"><span class="pre">featuresep</span></code> keyword must be called in the function.</p></li>
<li><p>Similarly, if one wishes to visualize a disk, the parameters <code class="docutils literal notranslate"><span class="pre">disk_height</span></code> and <code class="docutils literal notranslate"><span class="pre">disk_width</span></code> must be supplied to the function call.</p></li>
<li><p>The default values for <code class="docutils literal notranslate"><span class="pre">postarg</span></code> (target position offset from fiducial position) are set to (0,0), but other values can be supplied if one wishes to visualize an offset or non-supported aperture.</p></li>
<li><p>The default values for <code class="docutils literal notranslate"><span class="pre">avoidspikes</span></code> is 20 degrees, but can also be adjusted as the user sees fit.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="set-up-the-primary-function-show-orients">
<h2>Set up the primary function, <em>show_orients</em><a class="headerlink" href="#set-up-the-primary-function-show-orients" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_orients</span><span class="p">(</span><span class="n">orients</span><span class="p">,</span> <span class="n">aperture</span><span class="p">,</span> <span class="n">fov</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">featurepa</span><span class="p">,</span> <span class="n">postarg</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">avoidspikes</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    show_orients</span>
<span class="sd">    -----------------</span>
<span class="sd">    Function to visualize the location of a companion or disk feature of interest relative to the STIS diffraction spikes.</span>
<span class="sd">    Displays figure illustrating positions based upon ORIENT (+U3 vector) given a single value or a range of values.</span>
<span class="sd">    </span>
<span class="sd">    inputs</span>
<span class="sd">    ----------------</span>
<span class="sd">    orients       : (float or list) single ORIENT value or list of values </span>
<span class="sd">    aperture      : (str) which STIS occulting aperture position to use. Valid options are:</span>
<span class="sd">                            &#39;BAR10&#39;, &#39;BAR5&#39;, &#39;WEDGEA0.6&#39;, &#39;WEDGEA1.0&#39;, &#39;WEDGEA2.0&#39;, &#39;WEDGEB1.0&#39; </span>
<span class="sd">    fov           : (float) region of the detector to display, in arcsec                            </span>
<span class="sd">    feature       : (str) whether to display a point source companion or extended disk (&quot;companion&quot; or &quot;disk&quot;)</span>
<span class="sd">    featurepa     : (float) position angle of feature of interest in degrees E of N </span>
<span class="sd">    postarg       : (tuple) x, y offset from the fiducial aperture in arcsec. Default is no offset (0,0)</span>
<span class="sd">    avoidspikes   : (float, default=20) &#39;avoidance&#39; region to avoid stellar diffraction spikes    </span>

<span class="sd">    optional arguments</span>
<span class="sd">    -----------------</span>
<span class="sd">    featuresep    : (float) separation of companion</span>
<span class="sd">    disk_height   : (float) semiminor axis of the disk in arcsec</span>
<span class="sd">    disk_width    : (float) semimajor axis of the disk in arcsec</span>
<span class="sd">    </span>
<span class="sd">    returns</span>
<span class="sd">    ---------------</span>
<span class="sd">    (none - displays figures in line)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">orients</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">orients</span> <span class="o">=</span> <span class="p">[</span><span class="n">orients</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">orient</span> <span class="ow">in</span> <span class="n">orients</span><span class="p">:</span>

        <span class="c1"># initializing the figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
        <span class="c1"># setting the axis limits in [left, bottom, width, height]</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span> <span class="c1"># was 0.1 0.1, 0.8 0.8</span>

        <span class="c1"># the cartesian axis:</span>
        <span class="n">ax_cart</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
        <span class="c1"># the polar axis:</span>
        <span class="n">ax_polar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># setting the size of the zoomed view of the detector, defined manually</span>
        <span class="c1"># could also be set based upon which of the occulters is being used</span>
        <span class="n">ax_cart</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">fov</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_cart</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">fov</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">aperture</span> <span class="o">==</span> <span class="s1">&#39;BAR10&#39;</span><span class="p">:</span>
            <span class="n">rectangle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">1.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span>
            
            <span class="c1"># add edges of detector </span>
            <span class="n">bottom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">31.11</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">42.26</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">31.11</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">7.74</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">31.11</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">42.26</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">18.89</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">42.26</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">aperture</span> <span class="o">==</span> <span class="s1">&#39;BAR5&#39;</span><span class="p">:</span>
            <span class="n">rectangle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">1.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.15</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">angle</span><span class="o">=-</span><span class="mi">12</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span>   
            <span class="n">angle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">2.75</span> <span class="o">-</span> <span class="mf">1.25</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">angle2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">2.5</span> <span class="o">-</span> <span class="mf">1.25</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.85</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">angle2</span><span class="p">)</span>
            <span class="n">detedge</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">4</span><span class="o">-</span><span class="mf">1.25</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">10</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">detedge</span><span class="p">)</span>
            
        <span class="c1"># Add WEDGEA positions         </span>
        <span class="k">elif</span> <span class="n">aperture</span> <span class="o">==</span> <span class="s1">&#39;WEDGEA0.6&#39;</span><span class="p">:</span>
            <span class="c1"># wedge needs to start 6% up the detector, wedge origin about 10&quot; below detector</span>
            <span class="n">wedgeA1</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="mi">0</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">13.3</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">88.5</span><span class="p">,</span> <span class="mf">91.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeA1</span><span class="p">)</span>
            
            <span class="c1"># add wedgeB</span>
            <span class="n">wedgeB</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="o">-</span><span class="mi">25</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">11.85</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeB</span><span class="p">)</span>
            
            <span class="c1"># add edges of detector</span>
            <span class="n">bottom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">5.5</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">44.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">5.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">34.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">5.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">aperture</span> <span class="o">==</span> <span class="s1">&#39;WEDGEA1.0&#39;</span><span class="p">:</span>
            <span class="c1"># wedge needs to start 11% up the detector </span>
            <span class="n">wedgeA1</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="mi">0</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">20</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">88.5</span><span class="p">,</span> <span class="mf">91.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeA1</span><span class="p">)</span>      

            <span class="c1"># add wedgeB</span>
            <span class="n">wedgeB</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="o">-</span><span class="mi">25</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">4.47</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeB</span><span class="p">)</span>
            <span class="c1"># add edges of detector</span>
            <span class="n">bottom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.7</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">39.4</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.7</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">34.43</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.7</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">aperture</span> <span class="o">==</span> <span class="s1">&#39;WEDGEA2.0&#39;</span><span class="p">:</span>
            <span class="c1"># wedge needs to start 60% up the detector </span>
            <span class="n">wedgeA2</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="mi">0</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">40</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">88.5</span><span class="p">,</span> <span class="mf">91.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeA2</span><span class="p">)</span>
            
            <span class="c1"># add wedgeB</span>
            <span class="n">wedgeB</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="o">-</span><span class="mi">25</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">15.5</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeB</span><span class="p">)</span>
            
            <span class="c1"># add edges of detector</span>
            <span class="n">bottom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">30</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">20</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">30</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">34.43</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">30</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
            
        <span class="c1"># Add WEDGEB positions</span>
        <span class="k">elif</span> <span class="n">aperture</span> <span class="o">==</span> <span class="s1">&#39;WEDGEB1.0&#39;</span><span class="p">:</span>
            <span class="c1"># wedge needs to start 23% from the detector left edge</span>
            <span class="n">wedgeB</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="o">-</span><span class="mf">11.5</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">0</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeB</span><span class="p">)</span>     
            <span class="n">wedgeA1</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="mf">3.76</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">25</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">88.5</span><span class="p">,</span> <span class="mf">91.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeA1</span><span class="p">)</span> 
            
            <span class="c1"># add edges of detector</span>
            <span class="n">bottom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">11.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">14.89</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">11.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">35.1</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">11.5</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">14.89</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">38.5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">14.89</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">aperture</span> <span class="o">==</span> <span class="s1">&#39;WEDGEB2.0&#39;</span><span class="p">:</span>
            <span class="c1"># wedge needs to start 59% from the detector left edge</span>
            <span class="n">wedgeB</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="o">-</span><span class="mf">29.66</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">0</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeB</span><span class="p">)</span>     
            <span class="n">wedgeA1</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="o">-</span><span class="mf">14.83</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">20</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">88.5</span><span class="p">,</span> <span class="mf">91.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeA1</span><span class="p">)</span>      
            
            <span class="c1"># add edges of detector</span>
            <span class="n">bottom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">29.66</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.7</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">29.66</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">39.4</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">29.66</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.7</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">20.25</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.7</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>            
            
        <span class="k">elif</span> <span class="n">aperture</span> <span class="o">==</span> <span class="s1">&#39;WEDGEB2.5&#39;</span><span class="p">:</span>
            <span class="c1"># wedge needs to start 78.5% from the detector left edge</span>
            <span class="n">wedgeB</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="o">-</span><span class="mf">39.27</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">0</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeB</span><span class="p">)</span>     
            <span class="n">wedgeA1</span> <span class="o">=</span> <span class="n">Wedge</span><span class="p">((</span><span class="o">-</span><span class="mf">24.71</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">20</span><span class="o">-</span><span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">88.5</span><span class="p">,</span> <span class="mf">91.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># position, radius, theta1, theta2</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">wedgeA1</span><span class="p">)</span>                  
            
            <span class="c1"># add edges of detector</span>
            <span class="n">bottom</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">39.27</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.7</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">39.27</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">39.4</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">39.27</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.7</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mf">10.75</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.7</span> <span class="o">-</span> <span class="n">postarg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">)</span> <span class="c1"># tuple bottom lefthand corner, width, height</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>        

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Aperture </span><span class="si">{</span><span class="n">aperture</span><span class="si">}</span><span class="s2"> unknown (or yet unsupported).&quot;</span><span class="p">)</span>

        <span class="c1"># plot some text providing the value of the ORIENT and aperture</span>
        <span class="n">ax_cart</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.7</span><span class="o">*</span><span class="p">(</span><span class="n">fov</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mf">0.9</span><span class="o">*</span><span class="p">(</span><span class="n">fov</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;ORIENT = </span><span class="si">{</span><span class="n">orient</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$^{\circ}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">ax_cart</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.7</span><span class="o">*</span><span class="p">(</span><span class="n">fov</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mf">0.8</span><span class="o">*</span><span class="p">(</span><span class="n">fov</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">aperture</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

        <span class="c1"># add the polar plot</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;goldenrod&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>

        <span class="n">max_radius</span> <span class="o">=</span> <span class="n">fov</span><span class="o">/</span><span class="mi">2</span>

        <span class="c1"># Plot the various vectors</span>
        <span class="n">orient</span> <span class="o">=</span> <span class="n">orient</span>
        <span class="n">avoid</span> <span class="o">=</span> <span class="n">avoidspikes</span>
        <span class="n">u2</span> <span class="o">=</span> <span class="n">orient</span> <span class="o">+</span> <span class="mi">90</span>
        <span class="n">neg_u3</span> <span class="o">=</span> <span class="n">orient</span> <span class="o">+</span> <span class="mi">180</span>
        <span class="n">neg_u2</span> <span class="o">=</span> <span class="n">orient</span> <span class="o">+</span> <span class="mi">270</span>

        <span class="c1"># U3</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">orient</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;goldenrod&#39;</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">max_radius</span><span class="p">)</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">((</span><span class="n">orient</span><span class="o">-</span><span class="n">avoid</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="p">(</span><span class="n">orient</span><span class="o">+</span><span class="n">avoid</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_radius</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="c1"># U2</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">quiver</span><span class="p">((</span><span class="n">u2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;goldenrod&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">max_radius</span><span class="p">)</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">((</span><span class="n">u2</span><span class="o">-</span><span class="n">avoid</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="p">(</span><span class="n">u2</span><span class="o">+</span><span class="n">avoid</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_radius</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="c1"># -U3</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">quiver</span><span class="p">((</span><span class="n">neg_u3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;goldenrod&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">max_radius</span><span class="p">)</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">((</span><span class="n">neg_u3</span><span class="o">-</span><span class="n">avoid</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="p">(</span><span class="n">neg_u3</span><span class="o">+</span><span class="n">avoid</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_radius</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="c1"># -U2</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">quiver</span><span class="p">((</span><span class="n">neg_u2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;goldenrod&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">max_radius</span><span class="p">)</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">((</span><span class="n">neg_u2</span><span class="o">-</span><span class="n">avoid</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="p">(</span><span class="n">neg_u2</span><span class="o">+</span><span class="n">avoid</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_radius</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">&#39;companion&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;featuresep&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;Separation of companion not specified.&quot;</span><span class="p">)</span>
            <span class="n">planet_pa</span> <span class="o">=</span> <span class="n">featurepa</span>
            <span class="n">planet_sep</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;featuresep&#39;</span><span class="p">]</span>
            <span class="n">ax_polar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">planet_pa</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span> <span class="n">planet_sep</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">&#39;disk&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;disk_width&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;disk_height&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;Disk width and/or height not specified.&quot;</span><span class="p">)</span>
            <span class="n">el</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;disk_width&#39;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;disk_height&#39;</span><span class="p">],</span> <span class="o">-</span><span class="n">orient</span><span class="o">-</span><span class="mi">45</span><span class="o">+</span><span class="n">featurepa</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span> <span class="c1"># angle was incorrectly featurepa+90</span>
            <span class="n">ax_cart</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;Feature type not recognized (must be &#39;companion&#39; or &#39;disk&#39;).&quot;</span><span class="p">)</span>

        <span class="c1"># Plot vector showing true north</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">max_radius</span><span class="p">)</span>

        <span class="c1"># Set true north direction on polar plot and size</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">set_theta_zero_location</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=-</span><span class="p">(</span><span class="n">orient</span><span class="o">-</span><span class="mi">45</span><span class="p">))</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">set_rmax</span><span class="p">(</span><span class="n">max_radius</span><span class="p">)</span>
        <span class="n">ax_polar</span><span class="o">.</span><span class="n">set_rlabel_position</span><span class="p">((</span><span class="n">orient</span><span class="o">-</span><span class="mi">45</span><span class="p">)</span><span class="o">+</span><span class="mi">90</span><span class="p">)</span> <span class="c1"># set to be due east</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-1-star-with-a-companion-visible">
<h2>Example #1: Star with a companion (visible)<a class="headerlink" href="#example-1-star-with-a-companion-visible" title="Permalink to this heading">#</a></h2>
<section id="in-the-example-below-the-properties-of-the-point-source-companion-are-defined-in-line-in-the-function-call-directly-the-resulting-image-shows-the-following-features">
<h3>In the example below, the properties of the point-source companion are defined in-line in the function call directly. The resulting image shows the following features:<a class="headerlink" href="#in-the-example-below-the-properties-of-the-point-source-companion-are-defined-in-line-in-the-function-call-directly-the-resulting-image-shows-the-following-features" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>The telescope ORIENT position of 195º and the name of the selected occulter provided in the upper right.</p></li>
<li><p>10”x10” field of view from the visualization tool (<strong>Note</strong> that the field of view is shown in the <em>detector</em> reference frame)</p></li>
<li><p>A point source companion (magenta circle), with a separation of 1.75” and a position angle of 45º;</p></li>
<li><p>The true North angle is shown as the lime green arrow at 0º on the polar plot</p></li>
<li><p>Central star (center, orange star symbol) placed behind the BAR10 occulter (blue).</p></li>
<li><p>The four diffraction spikes from the central star are shown as orange arrows, with the ORIENT vector (+U3) shown as a bold arrow.</p></li>
<li><p>A 20º zone of avoidance is shown for each diffraction  spike (red shaded regions).</p></li>
</ul>
<p>Note that at this ORIENT angle, the companion would be visible and unaffected by scattered light from the diffraction spikes. This configuration also avoids accidental placement behind the occulter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_orients</span><span class="p">(</span><span class="n">orients</span><span class="o">=</span><span class="mi">195</span><span class="p">,</span> <span class="n">aperture</span><span class="o">=</span><span class="s1">&#39;BAR10&#39;</span><span class="p">,</span> <span class="n">fov</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">feature</span><span class="o">=</span><span class="s1">&#39;companion&#39;</span><span class="p">,</span> <span class="n">featurepa</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">featuresep</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="example-2-star-with-a-companion-obscured">
<h2>Example #2: Star with a companion (obscured)<a class="headerlink" href="#example-2-star-with-a-companion-obscured" title="Permalink to this heading">#</a></h2>
<section id="in-this-example-the-set-up-is-the-same-as-in-example-1-and-the-only-changed-parameter-is-the-orient-angle-resulting-in-an-obscured-companion-behind-the-bar10-occulter">
<h3>In this example, the set-up is the same as in Example #1 and the only changed parameter is the ORIENT angle, resulting in an obscured companion behind the BAR10 occulter.<a class="headerlink" href="#in-this-example-the-set-up-is-the-same-as-in-example-1-and-the-only-changed-parameter-is-the-orient-angle-resulting-in-an-obscured-companion-behind-the-bar10-occulter" title="Permalink to this heading">#</a></h3>
<p>Here, the configuration is virtually identical to Example #1 in terms of companion properties and occulter selection, but the ORIENT angle of the observatory has been changed from 195º in the previous example to 33º.</p>
<p>At this ORIENT angle, the companion would not only lie within the diffraction spike avoidance region (red shaded area), but would also be partially obscured by the BAR10 occulter itself.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_orients</span><span class="p">(</span><span class="n">orients</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">aperture</span><span class="o">=</span><span class="s1">&#39;BAR10&#39;</span><span class="p">,</span> <span class="n">fov</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">feature</span><span class="o">=</span><span class="s1">&#39;companion&#39;</span><span class="p">,</span> <span class="n">featurepa</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">featuresep</span><span class="o">=</span><span class="mf">1.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="example-3-star-with-a-simple-circumstellar-disk">
<h2>Example #3: Star with a simple circumstellar disk<a class="headerlink" href="#example-3-star-with-a-simple-circumstellar-disk" title="Permalink to this heading">#</a></h2>
<p>This example shows a simple disk feature, where the central star has been placed behind the WEDGEA1.0 occulter. The selected parameters are as follows:</p>
<ul class="simple">
<li><p>A 15”x15” field of view</p></li>
<li><p>The ORIENT angle of 45º means that the true North angle (green arrow) is aligned with the detector Y-axis (AXIS2).</p></li>
<li><p>The disk has a semimajor axis of 5”, semiminor axis of 1.5”, and position angle of 275º, as defined by the optional keyword arguments (disk_width = 10” and disk_height of 3”)</p></li>
<li><p>Zooming into the detector at this selected field of view shows both of the vertical WEDGEA and horizontal WEDGEB occulters (shown in blue), to aid in avoiding obstructions in the field of view.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_orients</span><span class="p">(</span><span class="n">orients</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">aperture</span><span class="o">=</span><span class="s1">&#39;WEDGEA1.0&#39;</span><span class="p">,</span> <span class="n">fov</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">feature</span><span class="o">=</span><span class="s1">&#39;disk&#39;</span><span class="p">,</span> <span class="n">featurepa</span><span class="o">=</span><span class="mi">275</span><span class="p">,</span> <span class="n">disk_width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">disk_height</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p><span class="xref myst">Top of Page</span>
<img style="float: right;" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" alt="Space Telescope Logo" width="200px"/>
<br></br>
<br></br></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/hst_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/STIS/CoronagraphyViz"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../drizpac_notebook/STIS_DrizzlePac_Tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">STIS DrizzlePac Tutorial <a class="tocSkip"></p>
      </div>
    </a>
    <a class="right-next"
       href="../calstis/calstis_2d_ccd.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Calstis 2-D CCD Data Reduction <a class="tocSkip"></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-stis-coronagraphy-planning-and-occulters">Introduction: STIS Coronagraphy Planning and Occulters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#guide-to-usage">Guide to Usage</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-additional-notes">Some additional notes:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-the-primary-function-show-orients">Set up the primary function, <em>show_orients</em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-star-with-a-companion-visible">Example #1: Star with a companion (visible)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-the-example-below-the-properties-of-the-point-source-companion-are-defined-in-line-in-the-function-call-directly-the-resulting-image-shows-the-following-features">In the example below, the properties of the point-source companion are defined in-line in the function call directly. The resulting image shows the following features:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-star-with-a-companion-obscured">Example #2: Star with a companion (obscured)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-example-the-set-up-is-the-same-as-in-example-1-and-the-only-changed-parameter-is-the-orient-angle-resulting-in-an-obscured-companion-behind-the-bar10-occulter">In this example, the set-up is the same as in Example #1 and the only changed parameter is the ORIENT angle, resulting in an obscured companion behind the BAR10 occulter.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-star-with-a-simple-circumstellar-disk">Example #3: Star with a simple circumstellar disk</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>