
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MIRI Imaging Pipeline Notebook &#8212; JWST Pipeline Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css?v=cd6c26fb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css?v=b44a18d9" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/MIRI/Imaging/JWPipeNB-MIRI-imaging';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="MIRI Imaging TSO Pipeline Notebook" href="../Imaging-TSO/JWPipeNB-MIRI-imaging-TSO.html" />
    <link rel="prev" title="MIRI Conagraphy Pipeline Notebook" href="../Coronagraphy/JWPipeNB-MIRI-Coron.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../README.html">
  
  
  
  
  
  
    <p class="title logo__title">JWST Pipeline Notebooks</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../README.html">
                    JWST Pipeline Notebooks
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MIRI</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Coronagraphy/JWPipeNB-MIRI-Coron.html">MIRI Coronagraphy Notebook</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">MIRI Imaging Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Imaging-TSO/JWPipeNB-MIRI-imaging-TSO.html">MIRI Imaging TSO Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LRS-slit/JWPipeNB-MIRI-LRS-slit.html">MIRI LRS Slit Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LRS-slitless-TSO/JWPipeNB-MIRI-LRS-slitless-TSO.html">MIRI LRS Slitless TSO Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MRS/JWPipeNB-MIRI-MRS.html">MIRI MRS Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRCAM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRCAM/Coronagraphy/JWPipeNB-nircam-coronagraphy.html">NIRCam Coronagraphy Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCAM/Imaging/JWPipeNB-nircam-imaging.html">NIRCam Imaging Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRISS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/AMI/JWPipeNB-niriss-ami.html">NIRISS AMI Pipeline Notebook</a></li>









<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/Imaging/JWPipeNB-niriss-imaging.html">NIRISS Imaging Pipeline Notebook</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRSpec</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRSPEC/BOTS/JWPipeNB-NIRSpec-BOTS.html">NIRSpec BOTS Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSPEC/FSlit/JWPipeNB-NIRSpec-FS.html">NIRSpec Fixed Slit Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSPEC/IFU/JWPipeNB-NIRSpec-IFU.html">NIRSpec IFU Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSPEC/MOS/JWPipeNB-NIRSpec-MOS.html">NIRSpec MOS Notebook</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/jwst-pipeline-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/jwst-pipeline-notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/MIRI/Imaging/JWPipeNB-MIRI-imaging.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/MIRI/Imaging/JWPipeNB-MIRI-imaging.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MIRI Imaging Pipeline Notebook</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration">1. Configuration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-dependencies-and-parameters">Install dependencies and parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-crds-context-and-server">Set CRDS context and server</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">2. Package Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo-mode-setup-ignore-if-not-using-demo-data">3. Demo Mode Setup (ignore if not using demo data)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-setup">4. Directory Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detector1-pipeline">5. Detector1 Pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-science-files">Calibrating Science Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-background-files">Calibrating Background Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-the-data">Exploring the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image2-pipeline">6. Image2 Pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-which-pipeline-steps-were-run-and-reference-files-used">Verify which pipeline steps were run and reference files used</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image3-pipeline">7. Image3 Pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-association-file">Create Association File</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-image3-stage-of-the-pipeline">Run Image3 stage of the pipeline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Verify which pipeline steps were run and reference files used</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-drizzle-combined-image">8. Visualize the drizzle-combined image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-detected-sources"><a id="detections">Visualize Detected Sources</a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-catalog-file-and-identify-point-extended-sources">Read in catalog file and identify point/extended sources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mark-the-extended-and-point-sources-on-the-image">Mark the extended and point sources on the image</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <a class="reference internal image-reference" href="https://github.com/spacetelescope/jwst-pipeline-notebooks/raw/main/_static/stsci_header.png"><img alt="stsci_logo" src="https://github.com/spacetelescope/jwst-pipeline-notebooks/raw/main/_static/stsci_header.png" style="width: 900px;" />
</a>
<section id="miri-imaging-pipeline-notebook">
<h1>MIRI Imaging Pipeline Notebook<a class="headerlink" href="#miri-imaging-pipeline-notebook" title="Link to this heading">#</a></h1>
<p><strong>Authors</strong>: M. Cracraft<br>
<strong>Last Updated</strong>: July 16, 2025<br>
<strong>Pipeline Version</strong>: 1.19.1 (Build 12.0)</p>
<p><strong>Purpose</strong>:<br>
This notebook provides a framework for processing generic Mid-Infrared Instrument
(MIRI) Imaging data through all
three James Webb Space Telescope (JWST) pipeline stages.  Data is assumed
to be located in one observation folder according to paths set up below.
It should not be necessary to edit any cells other than in the
<a class="reference internal" href="#1.-Configuration"><span class="xref myst">Configuration</span></a> section unless modifying the standard
pipeline processing options.</p>
<p><strong>Data</strong>:<br>
This example is set up to use an example dataset is from
<a class="reference external" href="https://www.stsci.edu/jwst/science-execution/program-information">Program ID</a>
1040 (PI: O. Detre, Co-I: A. Noriega-Crespo) which is an external flat commissioning program.
The MIRI imaging dataset uses a 5-step dither pattern. Example input data to use will be
downloaded automatically unless disabled (i.e., to use local files instead).</p>
<p><strong>JWST pipeline version and CRDS context</strong>:<br>
This notebook was written for the calibration pipeline version given above and uses the context associated with this version of the JWST Calibration Pipeline. Information about this an other contexts can be found in the JWST Calibration Reference Data System (CRDS) <a class="reference internal" href="#(https://jwst-crds.stsci.edu/)"><span class="xref myst">server</span></a>. If you use different pipeline
versions, please refer to the table <a class="reference external" href="https://jwst-crds.stsci.edu/display_build_contexts/">here</a> to determine what context to use. To learn more about the differences for the pipeline, read the relevant <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-science-calibration-pipeline/jwst-operations-pipeline-build-information">documentation</a><br></p>
<p><strong>Updates</strong>:<br>
This notebook is regularly updated as improvements are made to the
pipeline. Find the most up to date version of this notebook at:
https://github.com/spacetelescope/jwst-pipeline-notebooks/</p>
<p><strong>Recent Changes</strong>:<br>
September 25, 2024: original notebook released<br>
November 22, 2024: Updates to workflow when skipping pipeline modules<br>
January 16, 2025: Add handling for dedicated backgrounds, update to jwst 1.17.1<br>
May 5, 2025: Updated to jwst 1.18.0 (no significant changes)<br>
July 16, 2025: Updated to jwst 1.19.1 (no significant changes)</p>
<hr style="border:1px solid gray"> </hr><section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#1.-Configuration"><span class="xref myst">Configuration</span></a></p></li>
<li><p><a class="reference internal" href="#2.-Package-Imports"><span class="xref myst">Package Imports</span></a></p></li>
<li><p><a class="reference internal" href="#3.-Demo-Mode-Setup-(ignore-if-not-using-demo-data)"><span class="xref myst">Demo Mode Setup (ignore if not using demo data)</span></a></p></li>
<li><p><a class="reference internal" href="#4.-Directory-Setup"><span class="xref myst">Directory Setup</span></a></p></li>
<li><p><a class="reference internal" href="#5.-Detector1-Pipeline"><span class="xref myst">Detector 1 Pipeline</span></a></p></li>
<li><p><a class="reference internal" href="#6.-Image2-Pipeline"><span class="xref myst">Image2 Pipeline</span></a></p></li>
<li><p><a class="reference internal" href="#7.-Image3-Pipeline"><span class="xref myst">Image3 Pipeline</span></a></p></li>
<li><p><a class="reference internal" href="#8.-Visualize-the-drizzle-combined-image"><span class="xref myst">Visualize the data</span></a></p></li>
</ol>
<hr style="border:1px solid gray"> </hr></section>
<section id="configuration">
<h2>1. Configuration<a class="headerlink" href="#configuration" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Set basic configuration for running notebook.</p>
<section id="install-dependencies-and-parameters">
<h3>Install dependencies and parameters<a class="headerlink" href="#install-dependencies-and-parameters" title="Link to this heading">#</a></h3>
<p>To make sure that the pipeline version is compatabile with the steps
discussed below and the required dependencies and packages are installed,
you can create a fresh conda environment and install the provided
<code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file before starting this notebook: <br></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">miri_imaging_pipeline</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.11</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">miri_imaging_pipeline</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Set the basic parameters to use with this notebook. These will affect
what data is used, where data is located (if already in disk), and
pipeline modules run in this data. The list of parameters are:</p>
<ul class="simple">
<li><p>demo_mode</p></li>
<li><p>directories with data</p></li>
<li><p>pipeline modules</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic import necessary for configuration</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning">
Note that <code>demo_mode</code> must be set appropriately below.
</div>
<p>Set <code>demo_mode = True </code> to run in demonstration mode. In this
mode this notebook will download example data from the Barbara A.
Mikulski Archive for Space Telescopes
(<a class="reference external" href="https://mast.stsci.edu/portal/Mashup/Clients/Mast/Portal.html">MAST</a>)
and process it through the pipeline. This will all happen in a local
directory unless modified in
<a class="reference internal" href="#3.-Demo-Mode-Setup-(ignore-if-not-using-demo-data)"><span class="xref myst">Section 3</span></a> below.<br></p>
<p>Set <code>demo_mode = False</code> if you want to process your own data
that has already been downloaded and provide the location of the data.<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set parameters for demo_mode and processing steps.</span>

<span class="c1"># -----------------------------Demo Mode---------------------------------</span>
<span class="n">demo_mode</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running in demonstration mode using online example data!&#39;</span><span class="p">)</span>

<span class="c1"># --------------------------User Mode Directories------------------------</span>
<span class="c1"># If demo_mode = False, look for user data in these paths</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="c1"># Set directory paths for processing specific data; these will need</span>
    <span class="c1"># to be changed to your local directory setup (below are given as</span>
    <span class="c1"># examples)</span>
    <span class="n">user_home_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>

    <span class="c1"># Point to where science observation data are</span>
    <span class="c1"># Assumes uncalibrated data in sci_dir/uncal/ and results in stage1,</span>
    <span class="c1"># stage2, stage3 directories</span>
    <span class="n">sci_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">user_home_dir</span><span class="p">,</span> <span class="s1">&#39;FlightData/APT1040/data/Obs001/&#39;</span><span class="p">)</span>
    
    <span class="c1"># Point to where background observation data are</span>
    <span class="c1"># Assumes uncalibrated data in bg_dir/uncal/ and results in stage1 directory</span>
    <span class="c1">#bg_dir = os.path.join(user_home_dir, &#39;FlightData/APT1714/data/Obs02/&#39;)</span>
    <span class="n">bg_dir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1"># If no background observation, use an empty string</span>

<span class="c1"># --------------------------Set Processing Steps--------------------------</span>
<span class="c1"># Individual pipeline stages can be turned on/off here.  Note that a later</span>
<span class="c1"># stage won&#39;t be able to run unless data products have already been</span>
<span class="c1"># produced from the prior stage.</span>

<span class="c1"># Science processing</span>
<span class="n">dodet1</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># calwebb_detector1</span>
<span class="n">doimage2</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># calwebb_image2</span>
<span class="n">doimage3</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># calwebb_image3</span>
<span class="n">doviz</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Visualize calwebb_image3 results</span>

<span class="c1"># Background processing (if present)</span>
<span class="n">dodet1bg</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># calwebb_detector1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running in demonstration mode using online example data!
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-crds-context-and-server">
<h3>Set CRDS context and server<a class="headerlink" href="#set-crds-context-and-server" title="Link to this heading">#</a></h3>
<p>Before importing <code>CRDS</code> and <code>JWST</code> modules, we need
to configure our environment. This includes defining a CRDS cache
directory in which to keep the reference files that will be used by the
calibration pipeline.<br></p>
<p>If the root directory for the local CRDS cache directory has not been set
already, it will be set to create one in the home directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------------Set CRDS context and paths----------------------</span>
<span class="c1"># Each version of the calibration pipeline is associated with a specific CRDS</span>
<span class="c1"># context file. The pipeline will select the appropriate context file behind</span>
<span class="c1"># the scenes while running. However, if you wish to override the default context</span>
<span class="c1"># file and run the pipeline with a different context, you can set that using</span>
<span class="c1"># the CRDS_CONTEXT environment variable. Here we show how this is done,</span>
<span class="c1"># although we leave the line commented out in order to use the default context.</span>
<span class="c1"># If you wish to specify a different context, uncomment the line below.</span>
<span class="c1">#%env CRDS_CONTEXT jwst_1293.pmap</span>

<span class="c1"># Check whether the local CRDS cache directory has been set.</span>
<span class="c1"># If not, set it to the user home directory</span>
<span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;crds&#39;</span><span class="p">)</span>

<span class="c1"># Check whether the CRDS server URL has been set.  If not, set it.</span>
<span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;CRDS_SERVER_URL&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_SERVER_URL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;https://jwst-crds.stsci.edu&#39;</span>

<span class="c1"># Echo CRDS path in use</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRDS local filepath: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CRDS file server: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_SERVER_URL&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS local filepath: /home/runner/crds
CRDS file server: https://jwst-crds.stsci.edu
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
</section>
<section id="package-imports">
<h2>2. Package Imports<a class="headerlink" href="#package-imports" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the entire available screen width for this notebook</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;.container { width:95% !important; }&lt;/style&gt;&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>.container { width:95% !important; }</style></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic system utilities for interacting with files</span>
<span class="c1"># ----------------------General Imports------------------------------------</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="c1">#import urllib.request</span>

<span class="c1"># Numpy for doing calculations</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># To display full ouptut of cell, not just the last result</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.core.interactiveshell</span><span class="w"> </span><span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="n">InteractiveShell</span><span class="o">.</span><span class="n">ast_node_interactivity</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>

<span class="c1"># --------------------Astroquery Imports------------------------------</span>
<span class="c1"># ASCII files, and downloading demo files</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>

<span class="c1"># ----------------Matplotlib for visualizing images-------------------</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># -------------------Astropy routines for visualizing detected sources----------</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>

<span class="c1"># ----------------------JWST calibration pipeline------------------------</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jwst</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">crds</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Detector1Pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image2Pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image3Pipeline</span>

<span class="c1"># JWST pipeline utilities</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst</span><span class="w"> </span><span class="kn">import</span> <span class="n">datamodels</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.datamodels</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.associations</span><span class="w"> </span><span class="kn">import</span> <span class="n">asn_from_list</span> <span class="k">as</span> <span class="n">afl</span>  <span class="c1"># Tools for creating association files</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.associations.lib.rules_level2_base</span><span class="w"> </span><span class="kn">import</span> <span class="n">DMSLevel2bBase</span>  <span class="c1"># Definition of a Lvl2 association file</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.associations.lib.rules_level3_base</span><span class="w"> </span><span class="kn">import</span> <span class="n">DMS_Level3_Base</span>  <span class="c1"># Definition of a Lvl3 association file</span>

<span class="c1"># Echo pipeline version and CRDS context in use</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;JWST Calibration Pipeline Version: </span><span class="si">{</span><span class="n">jwst</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using CRDS Context: </span><span class="si">{</span><span class="n">crds</span><span class="o">.</span><span class="n">get_context_name</span><span class="p">(</span><span class="s1">&#39;jwst&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Calibration SW Found: jwst 1.19.1 (/home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/jwst-1.19.1.dist-info)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>JWST Calibration Pipeline Version: 1.19.1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using CRDS Context: jwst_1413.pmap
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start a timer to keep track of runtime</span>
<span class="n">time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
<section id="demo-mode-setup-ignore-if-not-using-demo-data">
<h2>3. Demo Mode Setup (ignore if not using demo data)<a class="headerlink" href="#demo-mode-setup-ignore-if-not-using-demo-data" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>If running in demonstration mode, set up the program information to
retrieve the uncalibrated data automatically from MAST using
<a class="reference external" href="https://astroquery.readthedocs.io/en/latest/mast/mast.html">astroquery</a>.
MAST allows for flexibility of searching by the proposal ID and the
observation ID instead of just filenames.<br></p>
<p>For illustrative purposes, we focus on data taken through the MIRI
<a class="reference external" href="https://jwst-docs.stsci.edu/jwst-mid-infrared-instrument/miri-observing-modes/miri-imaging#MIRIImaging-MIRIFiltersImagingfilters">F770W filter</a>
and start with uncalibrated data products. The files are named
<code class="docutils literal notranslate"><span class="pre">jw01040001005_03103_0000n_miri_uncal.fits</span></code>, where <em>n</em> refers to the
dither step number which ranges from 1 - 5.</p>
<p>More information about the JWST file naming conventions can be found at:
https://jwst-pipeline.readthedocs.io/en/latest/jwst/data_products/file_naming.html</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the program information and paths for demo program</span>
<span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running in demonstration mode and will download example data from MAST!&#39;</span><span class="p">)</span>
    <span class="n">program</span> <span class="o">=</span> <span class="s1">&#39;01040&#39;</span>
    <span class="n">sci_observtn</span> <span class="o">=</span> <span class="s2">&quot;001&quot;</span>
    <span class="n">visit</span> <span class="o">=</span> <span class="s2">&quot;005&quot;</span>
    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;mir_im_demo_data&#39;</span><span class="p">)</span>
    <span class="n">download_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
    <span class="n">sci_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;Obs&#39;</span> <span class="o">+</span> <span class="n">sci_observtn</span><span class="p">)</span>
    <span class="n">uncal_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span>
    <span class="n">bg_dir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="c1"># Ensure filepaths for input data exist</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">uncal_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">uncal_dir</span><span class="p">)</span>

    <span class="c1"># Create directory if it does not exist</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">data_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running in demonstration mode and will download example data from MAST!
</pre></div>
</div>
</div>
</div>
<p>Identify list of science (SCI) uncalibrated files associated with visits.</p>
<div class="alert alert-block alert-warning">
Selects only filter <i>f770w</i> data
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain a list of observation IDs for the specified demo program</span>
<span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="c1"># Science data</span>
    <span class="n">sci_obs_id_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">instrument_name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MIRI/IMAGE&quot;</span><span class="p">],</span>
                                                   <span class="n">provenance_name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CALJWST&quot;</span><span class="p">],</span>  <span class="c1"># Executed observations</span>
                                                   <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F770W&#39;</span><span class="p">],</span>  <span class="c1"># Data for Specific Filter</span>
                                                   <span class="n">obs_id</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;jw&#39;</span> <span class="o">+</span> <span class="n">program</span> <span class="o">+</span> <span class="s1">&#39;-o&#39;</span> <span class="o">+</span> <span class="n">sci_observtn</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span><span class="p">]</span>
                                                   <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn the list of visits into a list of uncalibrated data files</span>
<span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="c1"># Define types of files to select</span>
    <span class="n">file_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;uncal&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;SCIENCE&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;productSubGroupDescription&#39;</span><span class="p">:</span> <span class="s1">&#39;UNCAL&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;calib_level&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]}}</span>

    <span class="c1"># Science files</span>
    <span class="n">sci_files_to_download</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Loop over visits identifying uncalibrated files that are associated</span>
    <span class="c1"># with them</span>
    <span class="k">for</span> <span class="n">exposure</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sci_obs_id_table</span><span class="p">):</span>
        <span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">exposure</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">filetype</span><span class="p">,</span> <span class="n">query_dict</span> <span class="ow">in</span> <span class="n">file_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">filtered_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">productType</span><span class="o">=</span><span class="n">query_dict</span><span class="p">[</span><span class="s1">&#39;product_type&#39;</span><span class="p">],</span>
                                                             <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="n">query_dict</span><span class="p">[</span><span class="s1">&#39;productSubGroupDescription&#39;</span><span class="p">],</span>
                                                             <span class="n">calib_level</span><span class="o">=</span><span class="n">query_dict</span><span class="p">[</span><span class="s1">&#39;calib_level&#39;</span><span class="p">])</span>
            <span class="n">sci_files_to_download</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">filtered_products</span><span class="p">[</span><span class="s1">&#39;dataURI&#39;</span><span class="p">])</span>

    <span class="c1"># Download only the files in a single visit</span>
    <span class="n">sci_files_to_download</span> <span class="o">=</span> <span class="p">[</span><span class="n">match</span> <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">sci_files_to_download</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;jw&#39;</span> <span class="o">+</span> <span class="n">program</span> <span class="o">+</span> <span class="n">sci_observtn</span> <span class="o">+</span> <span class="n">visit</span><span class="p">)</span> <span class="ow">in</span> <span class="n">match</span><span class="p">]</span>
    <span class="n">sci_files_to_download</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sci_files_to_download</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Science files selected for downloading: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sci_files_to_download</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Science files selected for downloading: 5
</pre></div>
</div>
</div>
</div>
<p>Download all the uncal files and place them into the appropriate
directories.<br></p>
<div class="alert alert-block alert-warning">
Warning: If this notebook is halted during this step the downloaded file
may be incomplete, and cause crashes later on!
</div><div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">sci_files_to_download</span><span class="p">:</span>
        <span class="n">sci_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span>
                                                  <span class="n">local_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_dir</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00001_mirimage_uncal.fits with expected size 15909120. [astroquery.query]
INFO: Found cached file ./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00002_mirimage_uncal.fits with expected size 15909120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00003_mirimage_uncal.fits with expected size 15909120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00004_mirimage_uncal.fits with expected size 15909120. [astroquery.query]
INFO: Found cached file ./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00005_mirimage_uncal.fits with expected size 15909120. [astroquery.query]
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
<section id="directory-setup">
<h2>4. Directory Setup<a class="headerlink" href="#directory-setup" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Set up detailed paths to input/output stages here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define output subdirectories to keep science data products organized</span>
<span class="n">uncal_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span>  <span class="c1"># Uncalibrated pipeline inputs should be here</span>
<span class="n">det1_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_dir</span><span class="p">,</span> <span class="s1">&#39;stage1&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_detector1 pipeline outputs will go here</span>
<span class="n">image2_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_dir</span><span class="p">,</span> <span class="s1">&#39;stage2&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_spec2 pipeline outputs will go here</span>
<span class="n">image3_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_dir</span><span class="p">,</span> <span class="s1">&#39;stage3&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_spec3 pipeline outputs will go here</span>

<span class="c1"># Output subdirectories to keep background data products organized</span>
<span class="n">uncal_bgdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span>  <span class="c1"># Uncalibrated pipeline inputs should be here</span>
<span class="n">det1_bgdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_dir</span><span class="p">,</span> <span class="s1">&#39;stage1&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_detector1 pipeline outputs will go here</span>

<span class="c1"># We need to check that the desired output directories exist, and if not</span>
<span class="c1"># create them</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">det1_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">det1_dir</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">image2_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">image2_dir</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">image3_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">image3_dir</span><span class="p">)</span>
    
<span class="k">if</span> <span class="p">((</span><span class="n">bg_dir</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">det1_bgdir</span><span class="p">))):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">det1_bgdir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the time benchmark</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime so far: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="si">:</span><span class="s2">0.0f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Runtime so far: 5 seconds
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
<section id="detector1-pipeline">
<h2>5. Detector1 Pipeline<a class="headerlink" href="#detector1-pipeline" title="Link to this heading">#</a></h2>
<p>Run the datasets through the
<a class="reference external" href="https://jwst-docs.stsci.edu/jwst-science-calibration-pipeline-overview/stages-of-jwst-data-processing/calwebb_detector1">Detector1</a>
stage of the pipeline to apply detector level calibrations and create a
countrate data product where slopes are fitted to the integration ramps.
These <code class="docutils literal notranslate"><span class="pre">*_rate.fits</span></code> products are 2D (nrows x ncols), averaged over all
integrations. 3D countrate data products (<code class="docutils literal notranslate"><span class="pre">*_rateints.fits</span></code>) are also
created (nintegrations x nrows x ncols) which have the fitted ramp slopes
for each integration.<br></p>
<p>By default, all steps in the <code class="docutils literal notranslate"><span class="pre">Detector1</span></code> stage of the pipeline are run for
MIRI except: the <code class="docutils literal notranslate"><span class="pre">group_scale</span></code>, <code class="docutils literal notranslate"><span class="pre">ipc</span></code> and the <code class="docutils literal notranslate"><span class="pre">gain_scale</span></code> steps.<br></p>
<p>MIRI performs a few pipeline steps in calwebb_detector1 that are not performed for other instruments.
The <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/emicorr/index.html#emicorr-step">emicorr</a> step corrects
for known noise patterns in MIRI data. For certain subarrays, these noise patterns are clearly imprinted on
the data in the <code class="docutils literal notranslate"><span class="pre">rate.fits</span></code> files.<br></p>
<p>The <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/firstframe/index.html#firstframe-step">firstframe</a> step flags the first frame in each integration as bad, if the number of groups per integration is greater than 3.<br></p>
<p>The <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/lastframe/index.html#lastframe-step">lastframe</a> step
flags the last frame in each integration as bad, if the number of groups per integration is greater than 2.<br></p>
<p>The <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/reset/index.html#reset-step">reset</a> correction step
corrects for the reset anomaly effect. This effect is caused by the non-ideal behavior of the field effect
transistor (FET) upon resetting in the dark causing the initial frames in an integration to be offset
from their expected values.<br></p>
<p>The <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/rscd/index.html#rscd-step">rscd</a> step reads a reference
file for each data file and determines how many frames at the start of a ramp should be flagged as bad. There are a
number of nonlinearities at the start of MIRI ramps, and the flagging allows the more linear portion of the ramp to
be used for jump detection and ramp fitting, without using the initial, non-linear portion of the ramp. The number
of groups flagged depend on filter and subarray.<br></p>
<p>As of CRDS context <code class="docutils literal notranslate"><span class="pre">jwst_1201.pmap</span></code> and later, the
<a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/api/jwst.jump.JumpStep.html">jump</a> step
of the <code class="docutils literal notranslate"><span class="pre">DETECTOR1</span></code> stage of the pipeline will remove residuals associated
with <a class="reference external" href="https://jwst-docs.stsci.edu/known-issues-with-jwst-data/shower-and-snowball-artifacts">showers</a>
for the MIRI imaging mode, but only for data with filter F1500W and shorter. The default parameters for this correction,
where <code class="docutils literal notranslate"><span class="pre">find_showers</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code> turns on the shower
removal algorithm, are specified in the <code class="docutils literal notranslate"><span class="pre">pars-jumpstep</span></code> parameter
reference files. Users may wish to alter parameters to optimize removal of
shower residuals. Available parameters are discussed in the
<a class="reference external" href="https://www.stsci.edu/files/live/sites/www/files/home/jwst/documentation/technical-documents/_documents/JWST-STScI-008545.pdf">Detection and Flagging of Showers and Snowballs in JWST Technical Report (Regan 2023)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a dictionary to define how the Detector1 pipeline should be configured</span>

<span class="c1"># Boilerplate dictionary setup</span>
<span class="n">det1dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;group_scale&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;dq_init&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;emicorr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;firstframe&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;lastframe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;reset&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;linearity&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;rscd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;dark_current&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;refpix&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;jump&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;ramp_fit&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;gain_scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>

<span class="c1"># Overrides for whether or not certain steps should be skipped</span>
<span class="c1"># skipping the refpix step</span>
<span class="c1">#det1dict[&#39;refpix&#39;][&#39;skip&#39;] = True</span>
<span class="c1">#det1dict[&#39;jump&#39;][&#39;find_showers&#39;] = False # Turn off detection of cosmic ray showers</span>

<span class="c1"># Overrides for various reference files</span>
<span class="c1"># Files should be in the base local directory or provide full path</span>
<span class="c1">#det1dict[&#39;dq_init&#39;][&#39;override_mask&#39;] = &#39;myfile.fits&#39;  # Bad pixel mask</span>
<span class="c1">#det1dict[&#39;saturation&#39;][&#39;override_saturation&#39;] = &#39;myfile.fits&#39;  # Saturation</span>
<span class="c1">#det1dict[&#39;reset&#39;][&#39;override_reset&#39;] = &#39;myfile.fits&#39;  # Reset</span>
<span class="c1">#det1dict[&#39;linearity&#39;][&#39;override_linearity&#39;] = &#39;myfile.fits&#39;  # Linearity</span>
<span class="c1">#det1dict[&#39;rscd&#39;][&#39;override_rscd&#39;] = &#39;myfile.fits&#39;  # RSCD</span>
<span class="c1">#det1dict[&#39;dark_current&#39;][&#39;override_dark&#39;] = &#39;myfile.fits&#39;  # Dark current subtraction</span>
<span class="c1">#det1dict[&#39;jump&#39;][&#39;override_gain&#39;] = &#39;myfile.fits&#39;  # Gain used by jump step</span>
<span class="c1">#det1dict[&#39;ramp_fit&#39;][&#39;override_gain&#39;] = &#39;myfile.fits&#39;  # Gain used by ramp fitting step</span>
<span class="c1">#det1dict[&#39;jump&#39;][&#39;override_readnoise&#39;] = &#39;myfile.fits&#39;  # Read noise used by jump step</span>
<span class="c1">#det1dict[&#39;ramp_fit&#39;][&#39;override_readnoise&#39;] = &#39;myfile.fits&#39;  # Read noise used by ramp fitting step</span>

<span class="c1"># Turn on multi-core processing (off by default).  Choose what fraction of cores to use (quarter, half, or all)</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;jump&#39;</span><span class="p">][</span><span class="s1">&#39;maximum_cores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;half&#39;</span>

<span class="c1"># Alter parameters to optimize removal of shower residuals (example)</span>
<span class="c1">#det1dict[&#39;jump&#39;][&#39;after_jump_flag_dn1&#39;] = X  # A floating point value in units of DN</span>
<span class="c1">#det1dict[&#39;jump&#39;][&#39;after_jump_flag_time1&#39;] = x.x # A floating point value in units of seconds</span>
</pre></div>
</div>
</div>
</div>
<section id="calibrating-science-files">
<h3>Calibrating Science Files<a class="headerlink" href="#calibrating-science-files" title="Link to this heading">#</a></h3>
<p>Look for input science files and run calwebb_detector1 pipeline using the call method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uncal_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_dir</span><span class="p">,</span> <span class="s1">&#39;*_uncal.fits&#39;</span><span class="p">)))</span>
<span class="n">uncal_bgfiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_bgdir</span><span class="p">,</span> <span class="s1">&#39;*_uncal.fits&#39;</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uncal_files</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; science input files&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uncal_bgfiles</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; background input files&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 5 science input files
Found 0 background input files
</pre></div>
</div>
</div>
</div>
<p>Look at the first file to determine exposure parameters and practice using
JWST datamodels</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">dodet1</span><span class="p">:</span>
    <span class="c1"># print file name</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">uncal_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Open file as JWST datamodel</span>
    <span class="n">examine</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">uncal_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Print out exposure info</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Instrument: </span><span class="si">{</span><span class="n">examine</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">instrument</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filter: </span><span class="si">{</span><span class="n">examine</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">instrument</span><span class="o">.</span><span class="n">filter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of integrations: </span><span class="si">{</span><span class="n">examine</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">nints</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of groups: </span><span class="si">{</span><span class="n">examine</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">ngroups</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Readout pattern: </span><span class="si">{</span><span class="n">examine</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">readpatt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dither position number: </span><span class="si">{</span><span class="n">examine</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">dither</span><span class="o">.</span><span class="n">position_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00001_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Instrument: MIRI
Filter: F770W
Number of integrations: 1
Number of groups: 6
Readout pattern: FASTR1
Dither position number: 1
</pre></div>
</div>
</div>
</div>
<p>From the above, we confirm that the demo data file is for the MIRI instrument
using the <code class="docutils literal notranslate"><span class="pre">F770W</span></code> filter in the <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-mid-infrared-instrument/miri-instrumentation/miri-filters-and-dispersers#gsc.tab=0">Filter Wheel</a>. This observation uses
the MIRI <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-mid-infrared-instrument/miri-instrumentation/miri-detector-overview/miri-detector-readout-overview#gsc.tab=0">readout pattern</a> FASTR1,
6 groups per integration, and 1 integration per exposure. This data file
is the 1st dither position in this exposure sequence. For more information
about how JWST exposures are defined by up-the-ramp sampling, see the
<a class="reference external" href="https://jwst-docs.stsci.edu/understanding-exposure-times">Understanding Exposure Times JDox article</a>.<br></p>
<p>This metadata will be the same for all exposures in this observation other
than the dither position number.</p>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Detector1 stage of pipeline, specifying:</span>
<span class="c1"># output directory to save *_rate.fits files</span>
<span class="c1"># save_results flag set to True so the rate files are saved</span>

<span class="k">if</span> <span class="n">dodet1</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">uncal</span> <span class="ow">in</span> <span class="n">uncal_files</span><span class="p">:</span>
        <span class="n">rate_result</span> <span class="o">=</span> <span class="n">Detector1Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">uncal</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">det1_dir</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">det1dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping Detector1 processing&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,241 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,259 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,270 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0005.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,282 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,298 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,299 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,300 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,301 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,302 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,303 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,304 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,305 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,307 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,308 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,309 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,310 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,311 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,312 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,313 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,314 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,316 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,317 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,318 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,320 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,443 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (&#39;./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00001_mirimage_uncal.fits&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,463 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: True
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,484 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01040001005_03103_00001_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,486 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,487 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,488 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,488 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,489 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,489 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,490 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,490 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,490 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,491 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,492 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,492 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,492 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,493 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,728 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,736 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,737 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,739 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,874 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,886 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,931 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,941 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:18,955 - CRDS - INFO -  Calibration SW Found: jwst 1.19.1 (/home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/jwst-1.19.1.dist-info)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:19,058 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:19,190 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:19,215 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:19,234 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:19,235 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=FULL, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:19,235 - jwst.emicorr.emicorr - INFO - Will correct data for the following 1 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:19,236 - jwst.emicorr.emicorr - INFO -    [&#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:19,236 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,290 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,436 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,450 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,451 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,473 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,482 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,502 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,549 - stcal.saturation.saturation - INFO - Detected 820 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,552 - stcal.saturation.saturation - INFO - Detected 76 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,556 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,679 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,679 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,793 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,813 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,936 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:25,968 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,095 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,113 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,165 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,174 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,211 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,344 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,356 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,380 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,390 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,465 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,590 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,602 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,646 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,648 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,766 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:26,779 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:27,294 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:27,295 - stcal.dark_current.dark_sub - INFO - Science data nints=1, ngroups=6, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:27,295 - stcal.dark_current.dark_sub - INFO - Dark data nints=2, ngroups=360, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:27,821 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:27,947 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:27,948 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:28,075 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:28,076 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:28,196 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:28,204 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:28,205 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:28,223 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:28,226 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:28,268 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:28,269 - stcal.jump.jump - INFO - Creating 2 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,194 - stcal.jump.jump - INFO - Flagging Showers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,205 - stcal.jump.jump - WARNING - Not enough differences for shower detections
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,206 - stcal.jump.jump - INFO - Total showers= 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,206 - stcal.jump.jump - INFO - Total elapsed time = 0.937429 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,213 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 1.009358
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,216 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,341 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,342 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,473 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,509 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,509 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,536 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,536 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,554 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,559 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,560 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:29,962 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 0.4004828929901123
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,011 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,151 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,180 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,180 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,183 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,328 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(1, 1024, 1032) from jw01040001005_03103_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,351 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,351 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,353 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,428 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,429 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,429 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,501 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00001_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,501 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,502 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,526 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,541 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,552 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0005.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,564 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,580 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,581 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,582 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,583 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,584 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,585 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,586 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,587 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,588 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,588 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,590 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,590 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,591 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,592 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,593 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,594 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,596 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,597 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,598 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,599 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,736 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (&#39;./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00002_mirimage_uncal.fits&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,756 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: True
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,777 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01040001005_03103_00002_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,780 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,781 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,781 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,782 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,782 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,782 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,783 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,783 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,784 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,784 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,785 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,785 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,786 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:30,786 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,029 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,037 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,037 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,039 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,177 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,186 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,228 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,239 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,249 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,388 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,413 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,432 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,433 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=FULL, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,433 - jwst.emicorr.emicorr - INFO - Will correct data for the following 1 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,433 - jwst.emicorr.emicorr - INFO -    [&#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:31,434 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,460 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,587 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,598 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,598 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,620 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,629 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,643 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,681 - stcal.saturation.saturation - INFO - Detected 845 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,683 - stcal.saturation.saturation - INFO - Detected 80 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,688 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,829 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,830 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,969 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:37,994 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,134 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,154 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,282 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,292 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,341 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,350 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,387 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,523 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,533 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,555 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,564 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,636 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,757 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,766 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,808 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,810 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,930 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:38,939 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:39,438 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:39,439 - stcal.dark_current.dark_sub - INFO - Science data nints=1, ngroups=6, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:39,439 - stcal.dark_current.dark_sub - INFO - Dark data nints=2, ngroups=360, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,001 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,137 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,137 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,285 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,285 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,415 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,423 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,423 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,437 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,440 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,481 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:40,481 - stcal.jump.jump - INFO - Creating 2 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,406 - stcal.jump.jump - INFO - Flagging Showers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,419 - stcal.jump.jump - WARNING - Not enough differences for shower detections
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,419 - stcal.jump.jump - INFO - Total showers= 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,420 - stcal.jump.jump - INFO - Total elapsed time = 0.93824 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,427 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 1.003979
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,430 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,574 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,575 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,708 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,735 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,736 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,762 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,762 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,780 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,785 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:41,786 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,194 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 0.40610289573669434
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,235 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,358 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,380 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,380 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,382 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,507 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(1, 1024, 1032) from jw01040001005_03103_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,530 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,530 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,532 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,604 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00002_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,604 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,608 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,679 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00002_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,680 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,680 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,705 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,720 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,731 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0005.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,743 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,761 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,762 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,763 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,764 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,765 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,766 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,767 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,768 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,770 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,770 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,771 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,772 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,773 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,774 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,776 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,776 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,778 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,780 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,781 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,782 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,916 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (&#39;./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00003_mirimage_uncal.fits&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,937 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: True
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,958 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01040001005_03103_00003_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,961 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,961 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,962 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,962 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,963 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,963 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,964 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,964 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,965 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,966 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,966 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,967 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,967 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:42,968 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,209 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,217 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,217 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,219 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,338 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,347 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,397 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,408 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,422 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,562 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,582 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,600 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,600 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=FULL, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,600 - jwst.emicorr.emicorr - INFO - Will correct data for the following 1 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,601 - jwst.emicorr.emicorr - INFO -    [&#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:43,601 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,637 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,772 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,782 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,783 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,804 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,813 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,834 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,872 - stcal.saturation.saturation - INFO - Detected 801 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,875 - stcal.saturation.saturation - INFO - Detected 59 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:49,879 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,012 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,012 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,135 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,155 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,279 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,305 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,430 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,439 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,490 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,499 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,537 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,678 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,688 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,712 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,721 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,798 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,929 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,938 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,981 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:50,984 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:51,132 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:51,142 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:51,661 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:51,662 - stcal.dark_current.dark_sub - INFO - Science data nints=1, ngroups=6, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:51,662 - stcal.dark_current.dark_sub - INFO - Dark data nints=2, ngroups=360, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,213 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,349 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,350 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,468 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,469 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,589 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,596 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,597 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,612 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,614 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,656 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:52,657 - stcal.jump.jump - INFO - Creating 2 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,587 - stcal.jump.jump - INFO - Flagging Showers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,602 - stcal.jump.jump - WARNING - Not enough differences for shower detections
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,603 - stcal.jump.jump - INFO - Total showers= 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,603 - stcal.jump.jump - INFO - Total elapsed time = 0.94669 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,611 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 1.014478
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,614 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,746 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,747 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,861 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,889 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,889 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,915 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,915 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,934 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,939 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:53,940 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,347 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 0.40614819526672363
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,389 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,521 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,543 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,543 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,545 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,660 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(1, 1024, 1032) from jw01040001005_03103_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,682 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,683 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,685 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,755 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00003_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,756 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,757 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,826 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00003_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,827 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,828 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,851 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,867 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,877 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0005.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,889 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,906 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,907 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,908 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,909 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,910 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,911 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,913 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,914 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,915 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,916 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,917 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,918 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,919 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,920 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,921 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,922 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,923 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,925 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,926 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:54,927 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,077 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (&#39;./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00004_mirimage_uncal.fits&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,097 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: True
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,119 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01040001005_03103_00004_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,122 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,122 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,123 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,124 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,124 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,125 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,125 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,125 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,126 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,127 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,128 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,128 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,128 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,129 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,375 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,383 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,383 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,385 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,532 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,541 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,583 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,593 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,604 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,755 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,775 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,793 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,794 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=FULL, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,794 - jwst.emicorr.emicorr - INFO - Will correct data for the following 1 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,795 - jwst.emicorr.emicorr - INFO -    [&#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:26:55,795 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:01,859 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,005 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,016 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,017 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,039 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,049 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,068 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,109 - stcal.saturation.saturation - INFO - Detected 845 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,111 - stcal.saturation.saturation - INFO - Detected 60 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,116 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,264 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,265 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,412 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,433 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,584 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,610 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,744 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,753 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,804 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,814 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:02,848 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,002 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,012 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,036 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,046 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,120 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,259 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,269 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,312 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,315 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,453 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,462 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,969 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,970 - stcal.dark_current.dark_sub - INFO - Science data nints=1, ngroups=6, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:03,970 - stcal.dark_current.dark_sub - INFO - Dark data nints=2, ngroups=360, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,562 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,709 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,710 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,844 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,845 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,968 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,975 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,976 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,990 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:04,992 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:05,033 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:05,034 - stcal.jump.jump - INFO - Creating 2 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,007 - stcal.jump.jump - INFO - Flagging Showers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,018 - stcal.jump.jump - WARNING - Not enough differences for shower detections
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,019 - stcal.jump.jump - INFO - Total showers= 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,020 - stcal.jump.jump - INFO - Total elapsed time = 0.985749 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,027 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 1.051116
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,029 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,165 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,166 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,302 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,325 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,325 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,351 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,352 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,373 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,378 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,379 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,785 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 0.40462183952331543
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,828 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:06,982 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,005 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,005 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,008 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,146 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(1, 1024, 1032) from jw01040001005_03103_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,169 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,170 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,172 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,248 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00004_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,249 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,250 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,321 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00004_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,321 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,322 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,345 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,361 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,372 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0005.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,384 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,401 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,402 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,403 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,404 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,405 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,406 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,407 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,408 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,410 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,411 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,412 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,413 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,414 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,415 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,416 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,417 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,419 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,420 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,421 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,422 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,568 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (&#39;./mir_im_demo_data/Obs001/uncal/jw01040001005_03103_00005_mirimage_uncal.fits&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,589 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: True
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,611 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01040001005_03103_00005_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,614 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,614 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,615 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,615 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,616 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,617 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,617 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,618 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,618 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,619 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,620 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,620 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,620 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,621 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,877 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,885 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,886 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:07,887 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,034 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,044 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,081 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,093 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,103 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,243 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,268 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,286 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,287 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=FULL, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,287 - jwst.emicorr.emicorr - INFO - Will correct data for the following 1 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,288 - jwst.emicorr.emicorr - INFO -    [&#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:08,288 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,342 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,477 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,488 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,488 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,511 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,520 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,540 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,579 - stcal.saturation.saturation - INFO - Detected 826 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,581 - stcal.saturation.saturation - INFO - Detected 59 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,586 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,716 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,717 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,836 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,856 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:14,988 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,008 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,149 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,159 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0077.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,209 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,218 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,259 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,398 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,407 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,430 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,439 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,513 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,653 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,662 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,706 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,708 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,846 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:15,857 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0113.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:16,376 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:16,377 - stcal.dark_current.dark_sub - INFO - Science data nints=1, ngroups=6, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:16,378 - stcal.dark_current.dark_sub - INFO - Dark data nints=2, ngroups=360, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:16,959 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,087 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,087 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,230 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,231 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,364 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,372 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,372 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,386 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,389 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,430 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:17,430 - stcal.jump.jump - INFO - Creating 2 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,345 - stcal.jump.jump - INFO - Flagging Showers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,360 - stcal.jump.jump - WARNING - Not enough differences for shower detections
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,360 - stcal.jump.jump - INFO - Total showers= 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,361 - stcal.jump.jump - INFO - Total elapsed time = 0.930243 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,368 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 0.995673
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,371 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,504 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,505 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,632 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(1, 6, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,661 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,661 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,688 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,688 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,706 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,711 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:18,712 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,114 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 0.3999764919281006
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,157 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,303 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,324 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,325 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,327 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,472 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(1, 1024, 1032) from jw01040001005_03103_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,494 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,495 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,497 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,569 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00005_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,570 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,571 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,641 - stpipe.Detector1Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00005_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,641 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,642 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
</div>
</div>
</section>
<section id="calibrating-background-files">
<h3>Calibrating Background Files<a class="headerlink" href="#calibrating-background-files" title="Link to this heading">#</a></h3>
<p>Look for input background files and run calwebb_detector1
pipeline using the call method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Detector1 stage of pipeline on any background files</span>

<span class="k">if</span> <span class="n">dodet1bg</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">uncal</span> <span class="ow">in</span> <span class="n">uncal_bgfiles</span><span class="p">:</span>
        <span class="n">rate_result</span> <span class="o">=</span> <span class="n">Detector1Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">uncal</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">det1_bgdir</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">det1dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping Detector1 BG processing&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the time benchmark</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime for Detector1: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="si">:</span><span class="s2">0.0f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Runtime for Detector1: 68 seconds
</pre></div>
</div>
</div>
</div>
</section>
<section id="exploring-the-data">
<h3>Exploring the data<a class="headerlink" href="#exploring-the-data" title="Link to this heading">#</a></h3>
<p>Identify <code class="docutils literal notranslate"><span class="pre">*_rate.fits</span></code> files and verify which pipeline steps were run and
which calibration reference files were applied.<br></p>
<p>The header contains information about which calibration steps were
completed and skipped and which reference files were used to process the
data.<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">dodet1</span><span class="p">:</span>
    <span class="c1"># find rate files</span>
    <span class="n">rate_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det1_dir</span><span class="p">,</span> <span class="s1">&#39;*_rate.fits&#39;</span><span class="p">)))</span>

    <span class="c1"># Read in file as datamodel</span>
    <span class="n">rate_f</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">rate_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Check which steps were run</span>
    <span class="n">rate_f</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">cal_step</span><span class="o">.</span><span class="n">instance</span>

    <span class="c1"># Check which reference files were used to calibrate the dataset:</span>
    <span class="n">rate_f</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ref_file</span><span class="o">.</span><span class="n">instance</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;charge_migration&#39;: &#39;SKIPPED&#39;,
 &#39;clean_flicker_noise&#39;: &#39;SKIPPED&#39;,
 &#39;dark_sub&#39;: &#39;COMPLETE&#39;,
 &#39;dq_init&#39;: &#39;COMPLETE&#39;,
 &#39;emicorr&#39;: &#39;COMPLETE&#39;,
 &#39;firstframe&#39;: &#39;COMPLETE&#39;,
 &#39;gain_scale&#39;: &#39;SKIPPED&#39;,
 &#39;group_scale&#39;: &#39;SKIPPED&#39;,
 &#39;ipc&#39;: &#39;SKIPPED&#39;,
 &#39;jump&#39;: &#39;COMPLETE&#39;,
 &#39;lastframe&#39;: &#39;COMPLETE&#39;,
 &#39;linearity&#39;: &#39;COMPLETE&#39;,
 &#39;ramp_fit&#39;: &#39;COMPLETE&#39;,
 &#39;refpix&#39;: &#39;SKIPPED&#39;,
 &#39;reset&#39;: &#39;COMPLETE&#39;,
 &#39;rscd&#39;: &#39;COMPLETE&#39;,
 &#39;saturation&#39;: &#39;COMPLETE&#39;}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;crds&#39;: {&#39;context_used&#39;: &#39;jwst_1413.pmap&#39;, &#39;sw_version&#39;: &#39;13.0.6&#39;},
 &#39;dark&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_dark_0113.fits&#39;},
 &#39;emicorr&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_emicorr_0003.asdf&#39;},
 &#39;gain&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_gain_0034.fits&#39;},
 &#39;linearity&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_linearity_0032.fits&#39;},
 &#39;mask&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_mask_0036.fits&#39;},
 &#39;readnoise&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_readnoise_0085.fits&#39;},
 &#39;reset&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_reset_0077.fits&#39;},
 &#39;rscd&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_rscd_0017.fits&#39;},
 &#39;saturation&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_saturation_0034.fits&#39;},
 &#39;superbias&#39;: {&#39;name&#39;: &#39;N/A&#39;}}
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
</section>
<section id="image2-pipeline">
<h2>6. Image2 Pipeline<a class="headerlink" href="#image2-pipeline" title="Link to this heading">#</a></h2>
<p>In the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/pipeline/calwebb_image2.html">Image2</a> stage of the pipeline,
calibrated unrectified data products are created (<code class="docutils literal notranslate"><span class="pre">*_cal.fits</span></code> or
<code class="docutils literal notranslate"><span class="pre">*_calints.fits</span></code> files, depending on whether the input files are
<code class="docutils literal notranslate"><span class="pre">*_rate.fits</span></code> or <code class="docutils literal notranslate"><span class="pre">*_rateints.fits</span></code>).</p>
<p>In this pipeline processing stage, the
<a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/background_step/index.html#background-step">background subtraction</a>
step is performed if the data have a dedicated background defined,
the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/assign_wcs/index.html#assign-wcs-step">world coordinate system (WCS)</a>
is assigned, the data are <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/flatfield/index.html#flatfield-step">flat fielded</a>,
and a <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/photom/index.html#photom-step">photometric calibration</a>
is applied to convert from units of countrate (ADU/s) to surface brightness (MJy/sr).</p>
<p>The <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/resample/index.html#resample-step">resampling</a>
step is performed, to create resampled images of each dither position, but this is
only a quick-look product. The resampling step occurs during the <code class="docutils literal notranslate"><span class="pre">Image3</span></code> stage by
default. While the resampling step is done in the <code class="docutils literal notranslate"><span class="pre">Image2</span></code> stage, the data quality
from the <code class="docutils literal notranslate"><span class="pre">Image3</span></code> stage will be better since the bad pixels, which adversely affect
both the centroids and photometry in individual images, will be mostly
removed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_image2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a dictionary to define how the Image2 pipeline should be configured.</span>

<span class="c1"># Boilerplate dictionary setup</span>
<span class="n">image2dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;bkg_subtract&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;assign_wcs&#39;</span><span class="p">],</span> <span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;flat_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;photom&#39;</span><span class="p">],</span> <span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;resample&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>

<span class="c1"># Overrides for whether or not certain steps should be skipped (example)</span>
<span class="c1">#image2dict[&#39;resample&#39;][&#39;skip&#39;] = False</span>

<span class="c1"># Change the nsigma used for clipping the input background data</span>
<span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;bkg_subtract&#39;</span><span class="p">][</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Overrides for various reference files</span>
<span class="c1"># Files should be in the base local directory or provide full path</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_distortion&#39;] = &#39;myfile.asdf&#39;  # Spatial distortion (ASDF file)</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_filteroffset&#39;] = &#39;myfile.asdf&#39;  # Imager filter offsets (ASDF file)</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_specwcs&#39;] = &#39;myfile.asdf&#39;  # Spectral distortion (ASDF file)</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_wavelengthrange&#39;] = &#39;myfile.asdf&#39;  # Wavelength channel mapping (ASDF file)</span>
<span class="c1">#image2dict[&#39;flat_field&#39;][&#39;override_flat&#39;] = &#39;myfile.fits&#39;  # Pixel flatfield</span>
<span class="c1">#image2dict[&#39;photom&#39;][&#39;override_photom&#39;] = &#39;myfile.fits&#39;  # Photometric calibration array</span>
</pre></div>
</div>
</div>
</div>
<p>Define a function to create association files for Stage 2. This will enable use of the pixel-based background subtraction, if chosen above. This requires <em>one</em> input SCI file, but can have multiple input background files.</p>
<div class="alert alert-block alert-warning">
Note that the background will not be applied properly to all files if more than *one* SCI file is included in the association.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">writel2asn</span><span class="p">(</span><span class="n">onescifile</span><span class="p">,</span> <span class="n">bgfiles</span><span class="p">,</span> <span class="n">asnfile</span><span class="p">,</span> <span class="n">prodname</span><span class="p">):</span>
    <span class="c1"># Define the basic association of science files</span>
    <span class="n">asn</span> <span class="o">=</span> <span class="n">afl</span><span class="o">.</span><span class="n">asn_from_list</span><span class="p">([</span><span class="n">onescifile</span><span class="p">],</span> <span class="n">rule</span><span class="o">=</span><span class="n">DMSLevel2bBase</span><span class="p">,</span> <span class="n">product_name</span><span class="o">=</span><span class="n">prodname</span><span class="p">)</span>  <span class="c1"># Wrap in array since input was single exposure</span>

    <span class="c1"># Filter configuration for this sci file</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">onescifile</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
        <span class="n">hdu</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
        <span class="n">this_filter</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;FILTER&#39;</span><span class="p">]</span>

    <span class="c1"># If backgrounds were provided, find which are appropriate to this</span>
    <span class="c1"># filter and add to association</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">bgfiles</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
            <span class="n">hdu</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILTER&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">this_filter</span><span class="p">):</span>
                <span class="n">asn</span><span class="p">[</span><span class="s1">&#39;products&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;members&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;expname&#39;</span><span class="p">:</span> <span class="n">file</span><span class="p">,</span> <span class="s1">&#39;exptype&#39;</span><span class="p">:</span> <span class="s1">&#39;background&#39;</span><span class="p">})</span>              

    <span class="c1"># Write the association to a json file</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">serialized</span> <span class="o">=</span> <span class="n">asn</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asnfile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">serialized</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Find and sort all of the input files, ensuring use of absolute paths</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find all Science rate.fits files</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det1_dir</span><span class="p">,</span> <span class="s1">&#39;jw*rate.fits&#39;</span><span class="p">)</span>  <span class="c1"># Use files from the detector1 output folder</span>
<span class="n">rate_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rate_files</span><span class="p">)):</span>
    <span class="n">rate_files</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">rate_files</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
<span class="n">rate_files</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rate_files</span><span class="p">)</span>

<span class="c1"># Background Files</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det1_bgdir</span><span class="p">,</span> <span class="s1">&#39;jw*rate.fits&#39;</span><span class="p">)</span>
<span class="n">bgfiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bgfiles</span><span class="p">)):</span>
    <span class="n">bgfiles</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">bgfiles</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
<span class="n">bgfiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bgfiles</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found  </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rate_files</span><span class="p">))</span><span class="si">}</span><span class="s2"> science files&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found  </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bgfiles</span><span class="p">))</span><span class="si">}</span><span class="s2"> background files&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found  5 science files
Found  0 background files
</pre></div>
</div>
</div>
</div>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Image2 stage of pipeline, specifying the output directory to save *_cal.fits files</span>
<span class="c1"># and save_results flag set to True so the rate files are saved</span>
<span class="k">if</span> <span class="n">doimage2</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">rate_files</span><span class="p">:</span>
        <span class="n">asnfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_dir</span><span class="p">,</span> <span class="s1">&#39;l2asn.json&#39;</span><span class="p">)</span>
        <span class="n">writel2asn</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="n">bgfiles</span><span class="p">,</span> <span class="n">asnfile</span><span class="p">,</span> <span class="s1">&#39;Level2&#39;</span><span class="p">)</span>
        <span class="n">cal_result</span> <span class="o">=</span> <span class="n">Image2Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">asnfile</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">image2_dir</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">image2dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipping Image2 processing.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,793 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,802 - stpipe - INFO - PARS-IMAGE2PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-image2pipeline_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,812 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,814 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,816 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,817 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,818 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,819 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,963 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./mir_im_demo_data/Obs001/l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:19,971 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: False
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: False
      sigma: 2
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,016 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,019 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,020 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,020 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,021 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,021 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,021 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,022 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,022 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,023 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,023 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,025 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,025 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,026 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,026 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,027 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,027 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,028 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,028 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,028 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,030 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,030 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,031 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,031 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,037 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00001_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,038 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00001_mirimage_rate.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,216 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00001_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,378 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,428 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.522590500 -69.442259683 80.541421228 -69.472834075 80.628988786 -69.466212482 80.610814720 -69.435536112
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,429 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  80.522590500 -69.442259683 80.541421228 -69.472834075 80.628988786 -69.466212482 80.610814720 -69.435536112
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,429 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,463 - py.warnings - WARNING - /home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/gwcs/wcs/_wcs.py:1790: LinAlgWarning: Failed to achieve requested SIP approximation accuracy.
  fit_inv_poly_u, fit_inv_poly_v, max_inv_resid = fit_2D_poly(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,475 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,612 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00001_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,655 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,656 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,656 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,657 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,720 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,852 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00001_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,868 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,869 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,894 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,894 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,895 - jwst.photom.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,895 - jwst.photom.photom - INFO -  filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,926 - jwst.photom.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,926 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from AREA reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,928 - jwst.photom.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,928 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,933 - jwst.photom.photom - INFO - PHOTMJSR value: 0.257756
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:20,948 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,089 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00001_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,120 - jwst.resample.resample_utils - INFO - Pixel scale ratio (pscale_out/pscale_in): 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,120 - jwst.resample.resample_utils - INFO - Computed output pixel scale: 0.11091590874981953 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,127 - stcal.resample.resample - INFO - Output pixel scale: 0.11091590874981953 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,128 - stcal.resample.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,128 - stcal.resample.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,129 - stcal.resample.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,129 - stcal.resample.resample - INFO - Driz parameter weight_type: exptime
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,133 - jwst.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,584 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:21,828 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,023 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,219 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,515 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.522470432 -69.442135354 80.541076384 -69.472844353 80.629482750 -69.466224295 80.610756230 -69.435524754
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,612 - stpipe.Image2Pipeline.resample - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00001_mirimage_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,613 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,614 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00001_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,614 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,615 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,742 - stpipe.Image2Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,743 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,744 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,802 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,810 - stpipe - INFO - PARS-IMAGE2PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-image2pipeline_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,821 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,822 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,823 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,825 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,826 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,827 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,975 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./mir_im_demo_data/Obs001/l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:22,983 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: False
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: False
      sigma: 2
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,028 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,031 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,032 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,032 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,033 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,033 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,034 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,034 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,035 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,035 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,035 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,036 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,036 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,037 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,037 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,037 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,038 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,038 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,039 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,040 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,040 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,040 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,041 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,041 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,047 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00002_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,048 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00002_mirimage_rate.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,218 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00002_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,317 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,369 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.519758777 -69.441179341 80.538584462 -69.471754044 80.626148504 -69.465133897 80.607979465 -69.434457227
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,370 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  80.519758777 -69.441179341 80.538584462 -69.471754044 80.626148504 -69.465133897 80.607979465 -69.434457227
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,370 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,403 - py.warnings - WARNING - /home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/gwcs/wcs/_wcs.py:1790: LinAlgWarning: Failed to achieve requested SIP approximation accuracy.
  fit_inv_poly_u, fit_inv_poly_v, max_inv_resid = fit_2D_poly(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,415 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,565 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00002_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,604 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,604 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,605 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,605 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,673 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,807 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00002_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,820 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,820 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,847 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,847 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,848 - jwst.photom.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,848 - jwst.photom.photom - INFO -  filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,875 - jwst.photom.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,875 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from AREA reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,876 - jwst.photom.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,877 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,882 - jwst.photom.photom - INFO - PHOTMJSR value: 0.257756
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:23,898 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,035 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00002_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,066 - jwst.resample.resample_utils - INFO - Pixel scale ratio (pscale_out/pscale_in): 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,066 - jwst.resample.resample_utils - INFO - Computed output pixel scale: 0.11091590886942379 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,073 - stcal.resample.resample - INFO - Output pixel scale: 0.11091590886942379 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,074 - stcal.resample.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,074 - stcal.resample.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,075 - stcal.resample.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,075 - stcal.resample.resample - INFO - Driz parameter weight_type: exptime
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,079 - jwst.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,529 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,773 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:24,968 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,164 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,469 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.519638732 -69.441055010 80.538239633 -69.471764316 80.626642442 -69.465145718 80.607920980 -69.434445868
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,569 - stpipe.Image2Pipeline.resample - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00002_mirimage_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,570 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,572 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00002_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,573 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,574 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,704 - stpipe.Image2Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00002_mirimage_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,704 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,705 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,766 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,776 - stpipe - INFO - PARS-IMAGE2PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-image2pipeline_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,786 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,788 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,789 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,790 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,791 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,792 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,928 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./mir_im_demo_data/Obs001/l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,936 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: False
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: False
      sigma: 2
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,980 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,983 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,984 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,984 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,985 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,985 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,986 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,986 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,987 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,987 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,988 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,988 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,989 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,989 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,990 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,990 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,990 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,991 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,992 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,992 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,993 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,993 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,993 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:25,994 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,000 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00003_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,000 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00003_mirimage_rate.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,182 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00003_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,277 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,328 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.517110392 -69.438899816 80.535930509 -69.469474789 80.623486029 -69.462855905 80.605322513 -69.432178972
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,329 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  80.517110392 -69.438899816 80.535930509 -69.469474789 80.623486029 -69.462855905 80.605322513 -69.432178972
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,329 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,362 - py.warnings - WARNING - /home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/gwcs/wcs/_wcs.py:1790: LinAlgWarning: Failed to achieve requested SIP approximation accuracy.
  fit_inv_poly_u, fit_inv_poly_v, max_inv_resid = fit_2D_poly(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,373 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,508 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00003_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,545 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,545 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,546 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,546 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,609 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,754 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00003_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,766 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,766 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,793 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,794 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,794 - jwst.photom.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,795 - jwst.photom.photom - INFO -  filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,822 - jwst.photom.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,823 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from AREA reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,824 - jwst.photom.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,825 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,830 - jwst.photom.photom - INFO - PHOTMJSR value: 0.257756
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,845 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:26,997 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00003_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,029 - jwst.resample.resample_utils - INFO - Pixel scale ratio (pscale_out/pscale_in): 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,030 - jwst.resample.resample_utils - INFO - Computed output pixel scale: 0.1109159089078686 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,037 - stcal.resample.resample - INFO - Output pixel scale: 0.1109159089078686 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,037 - stcal.resample.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,038 - stcal.resample.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,038 - stcal.resample.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,038 - stcal.resample.resample - INFO - Driz parameter weight_type: exptime
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,043 - jwst.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,495 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,740 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:27,936 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,133 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,442 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.516990373 -69.438775482 80.535585712 -69.469485056 80.623979910 -69.462867733 80.605264034 -69.432167612
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,538 - stpipe.Image2Pipeline.resample - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00003_mirimage_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,538 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,539 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00003_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,540 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,541 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,669 - stpipe.Image2Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00003_mirimage_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,670 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,670 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,728 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,737 - stpipe - INFO - PARS-IMAGE2PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-image2pipeline_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,747 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,748 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,749 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,750 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,751 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,753 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,896 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./mir_im_demo_data/Obs001/l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,904 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: False
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: False
      sigma: 2
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,951 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,954 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,954 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,955 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,955 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,956 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,956 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,956 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,957 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,958 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,958 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,959 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,959 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,959 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,960 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,960 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,960 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,961 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,961 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,962 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,962 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,963 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,963 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,964 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,970 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00004_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:28,970 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00004_mirimage_rate.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,161 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00004_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,259 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,308 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.513336007 -69.439821548 80.532151500 -69.470396933 80.619711963 -69.463779964 80.601553105 -69.433102634
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,309 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  80.513336007 -69.439821548 80.532151500 -69.470396933 80.619711963 -69.463779964 80.601553105 -69.433102634
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,310 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,342 - py.warnings - WARNING - /home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/gwcs/wcs/_wcs.py:1790: LinAlgWarning: Failed to achieve requested SIP approximation accuracy.
  fit_inv_poly_u, fit_inv_poly_v, max_inv_resid = fit_2D_poly(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,353 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,496 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00004_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,533 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,534 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,534 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,535 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,599 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,753 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00004_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,766 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,766 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,795 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,796 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,796 - jwst.photom.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,797 - jwst.photom.photom - INFO -  filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,825 - jwst.photom.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,825 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from AREA reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,827 - jwst.photom.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,827 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,832 - jwst.photom.photom - INFO - PHOTMJSR value: 0.257756
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,848 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:29,998 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00004_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,029 - jwst.resample.resample_utils - INFO - Pixel scale ratio (pscale_out/pscale_in): 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,029 - jwst.resample.resample_utils - INFO - Computed output pixel scale: 0.11091590921335213 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,036 - stcal.resample.resample - INFO - Output pixel scale: 0.11091590921335213 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,037 - stcal.resample.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,037 - stcal.resample.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,038 - stcal.resample.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,038 - stcal.resample.resample - INFO - Driz parameter weight_type: exptime
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,042 - jwst.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,490 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,734 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:30,933 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,134 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,438 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.513216006 -69.439697212 80.531806689 -69.470407193 80.620205865 -69.463791803 80.601494627 -69.433091273
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,536 - stpipe.Image2Pipeline.resample - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00004_mirimage_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,537 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,539 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00004_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,540 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,541 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,668 - stpipe.Image2Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00004_mirimage_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,669 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,669 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,727 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,735 - stpipe - INFO - PARS-IMAGE2PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-image2pipeline_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,746 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,747 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,749 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,750 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,751 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,752 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,899 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./mir_im_demo_data/Obs001/l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,907 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: False
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: False
      sigma: 2
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,954 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,957 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,957 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,958 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,958 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,959 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,959 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,960 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,960 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,961 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,961 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,961 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,962 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,962 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,963 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,964 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,965 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,965 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,966 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,966 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,967 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,967 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,968 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,968 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,975 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00005_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:31,975 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00005_mirimage_rate.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,155 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00005_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,253 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0008.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,303 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.515622414 -69.443455639 80.534444344 -69.474030777 80.622018926 -69.467412656 80.603853712 -69.436735566
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,304 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  80.515622414 -69.443455639 80.534444344 -69.474030777 80.622018926 -69.467412656 80.603853712 -69.436735566
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,305 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,338 - py.warnings - WARNING - /home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/gwcs/wcs/_wcs.py:1790: LinAlgWarning: Failed to achieve requested SIP approximation accuracy.
  fit_inv_poly_u, fit_inv_poly_v, max_inv_resid = fit_2D_poly(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,349 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,492 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00005_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,530 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0829.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,530 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,531 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,531 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,595 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,735 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00005_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,748 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,748 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /home/runner/crds/references/jwst/miri/jwst_miri_area_0006.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,774 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,774 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,775 - jwst.photom.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,776 - jwst.photom.photom - INFO -  filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,804 - jwst.photom.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,804 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from AREA reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,806 - jwst.photom.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,806 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,812 - jwst.photom.photom - INFO - PHOTMJSR value: 0.257756
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,827 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:32,974 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00005_mirimage_image2pipeline.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,006 - jwst.resample.resample_utils - INFO - Pixel scale ratio (pscale_out/pscale_in): 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,007 - jwst.resample.resample_utils - INFO - Computed output pixel scale: 0.11091590924628925 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,014 - stcal.resample.resample - INFO - Output pixel scale: 0.11091590924628925 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,014 - stcal.resample.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,015 - stcal.resample.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,015 - stcal.resample.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,015 - stcal.resample.resample - INFO - Driz parameter weight_type: exptime
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,019 - jwst.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,465 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,709 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:33,905 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,101 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1019, 1029)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,402 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.515502380 -69.443331306 80.534099480 -69.474041043 80.622512917 -69.467424488 80.603795222 -69.436724206
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,500 - stpipe.Image2Pipeline.resample - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00005_mirimage_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,501 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,503 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/notebook-ci-testing/notebook-ci-testing/notebooks/MIRI/Imaging/mir_im_demo_data/Obs001/stage1/jw01040001005_03103_00005_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,504 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,505 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,635 - stpipe.Image2Pipeline - INFO - Saved model in ./mir_im_demo_data/Obs001/stage2/jw01040001005_03103_00005_mirimage_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,636 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,636 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the time benchmark</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime so far: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="si">:</span><span class="s2">0.0f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime for Image2: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time_image2</span><span class="si">:</span><span class="s2">0.0f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Runtime so far: 83 seconds
Runtime for Image2: 15 seconds
</pre></div>
</div>
</div>
</div>
<section id="verify-which-pipeline-steps-were-run-and-reference-files-used">
<h3>Verify which pipeline steps were run and reference files used<a class="headerlink" href="#verify-which-pipeline-steps-were-run-and-reference-files-used" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">doimage2</span><span class="p">:</span>
    <span class="c1"># Identify *_cal.fits files</span>
    <span class="n">cal_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image2_dir</span><span class="p">,</span> <span class="s1">&#39;*_cal.fits&#39;</span><span class="p">)))</span>

    <span class="n">cal_f</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">cal_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Check which steps were run:</span>
    <span class="n">cal_f</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">cal_step</span><span class="o">.</span><span class="n">instance</span>

    <span class="c1"># Check which reference files were used to calibrate the dataset:</span>
    <span class="n">cal_f</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ref_file</span><span class="o">.</span><span class="n">instance</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;assign_wcs&#39;: &#39;COMPLETE&#39;,
 &#39;charge_migration&#39;: &#39;SKIPPED&#39;,
 &#39;clean_flicker_noise&#39;: &#39;SKIPPED&#39;,
 &#39;dark_sub&#39;: &#39;COMPLETE&#39;,
 &#39;dq_init&#39;: &#39;COMPLETE&#39;,
 &#39;emicorr&#39;: &#39;COMPLETE&#39;,
 &#39;firstframe&#39;: &#39;COMPLETE&#39;,
 &#39;flat_field&#39;: &#39;COMPLETE&#39;,
 &#39;gain_scale&#39;: &#39;SKIPPED&#39;,
 &#39;group_scale&#39;: &#39;SKIPPED&#39;,
 &#39;ipc&#39;: &#39;SKIPPED&#39;,
 &#39;jump&#39;: &#39;COMPLETE&#39;,
 &#39;lastframe&#39;: &#39;COMPLETE&#39;,
 &#39;linearity&#39;: &#39;COMPLETE&#39;,
 &#39;photom&#39;: &#39;COMPLETE&#39;,
 &#39;ramp_fit&#39;: &#39;COMPLETE&#39;,
 &#39;refpix&#39;: &#39;SKIPPED&#39;,
 &#39;reset&#39;: &#39;COMPLETE&#39;,
 &#39;rscd&#39;: &#39;COMPLETE&#39;,
 &#39;saturation&#39;: &#39;COMPLETE&#39;}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;area&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_area_0006.fits&#39;},
 &#39;camera&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;collimator&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;crds&#39;: {&#39;context_used&#39;: &#39;jwst_1413.pmap&#39;, &#39;sw_version&#39;: &#39;13.0.6&#39;},
 &#39;dark&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_dark_0113.fits&#39;},
 &#39;dflat&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;disperser&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;distortion&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_distortion_0047.asdf&#39;},
 &#39;emicorr&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_emicorr_0003.asdf&#39;},
 &#39;fflat&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;filteroffset&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_filteroffset_0008.asdf&#39;},
 &#39;flat&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_flat_0829.fits&#39;},
 &#39;fore&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;fpa&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;gain&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_gain_0034.fits&#39;},
 &#39;ifufore&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;ifupost&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;ifuslicer&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;linearity&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_linearity_0032.fits&#39;},
 &#39;mask&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_mask_0036.fits&#39;},
 &#39;msa&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;ote&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;photom&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_photom_0218.fits&#39;},
 &#39;readnoise&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_readnoise_0085.fits&#39;},
 &#39;regions&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;reset&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_reset_0077.fits&#39;},
 &#39;rscd&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_rscd_0017.fits&#39;},
 &#39;saturation&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_saturation_0034.fits&#39;},
 &#39;sflat&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;specwcs&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;superbias&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;wavelengthrange&#39;: {&#39;name&#39;: &#39;N/A&#39;}}
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
</section>
<section id="image3-pipeline">
<h2>7. Image3 Pipeline<a class="headerlink" href="#image3-pipeline" title="Link to this heading">#</a></h2>
<p>In the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/pipeline/calwebb_image3.html">Image3</a>
stage of the pipeline, the individual <code class="docutils literal notranslate"><span class="pre">*_cal.fits</span></code> files for each of the dither positions are
combined to one single distortion corrected image. First, an
<a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/associations/overview.html">Association</a>
needs to be created to inform the pipeline that these individual exposures are linked together.</p>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">Image3</span></code> stage of the pipeline performs the following steps on MIRI data:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/tweakreg/index.html#tweakreg-step">tweakreg</a> -
creates source catalogs of pointlike sources for each input image. The source catalog for each input
image is compared to each other to derive coordinate transforms to align the images relative to each other.</p>
<ul>
<li><p>As of pipeline version 1.14.0, the default source finding algorithm is <code class="docutils literal notranslate"><span class="pre">IRAFStarFinder</span></code>.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/skymatch/index.html#skymatch-step">skymatch</a> -
measures the background level from the sky to use as input into the subsequent <code class="docutils literal notranslate"><span class="pre">outlier</span> <span class="pre">detection</span></code> and <code class="docutils literal notranslate"><span class="pre">resample</span></code> steps.</p></li>
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/outlier_detection/index.html#outlier-detection-step">outlier detection</a> -
flags any remaining cosmic rays, bad pixels, or other artifacts not already flagged during the <code class="docutils literal notranslate"><span class="pre">DETECTOR1</span></code> stage
of the pipeline, using all input images to create a median image so that outliers in individual images can be identified.</p></li>
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/resample/index.html#resample-step">resample</a> -
resamples each input image based on its WCS and distortion information and creates a single undistorted image.</p></li>
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/source_catalog/index.html#source-catalog-step">source catalog</a> -
creates a catalog of detected sources along with measured photometries and morphologies (i.e., point-like vs extended).
Useful for quicklooks, but optimization is likely needed for specific science cases. Users may wish to experiment with
changing the <code class="docutils literal notranslate"><span class="pre">snr_threshold</span></code> and <code class="docutils literal notranslate"><span class="pre">deblend</span></code> options. Modifications to the following parameters will not significantly
improve data quality and it is advised to keep them at their default values: <code class="docutils literal notranslate"><span class="pre">aperture_ee1</span></code>, <code class="docutils literal notranslate"><span class="pre">aperture_ee2</span></code>,
<code class="docutils literal notranslate"><span class="pre">aperture_ee3</span></code>, <code class="docutils literal notranslate"><span class="pre">ci1_star_threshold</span></code>, <code class="docutils literal notranslate"><span class="pre">ci2_star_threshold</span></code>.</p></li>
</ul>
<p>Some values that have been shown to give good results for MIRI data are to set the outlier_detections parameter <code class="docutils literal notranslate"><span class="pre">scale</span></code>
to 1.0 0.8 and to set the resample parameter <code class="docutils literal notranslate"><span class="pre">weight_type</span></code> to exptime, both currently set in the
<a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/stpipe/parameter_files.html#parameter-files">parameter reference file</a>
<I>pars-outlierdetectionstep</I>, but can be overridden as indicated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_image3</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a dictionary to define how the Image3 pipeline should be configured</span>
<span class="c1"># Boilerplate dictionary setup</span>
<span class="n">image3dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">image3dict</span><span class="p">[</span><span class="s1">&#39;assign_mtwcs&#39;</span><span class="p">],</span> <span class="n">image3dict</span><span class="p">[</span><span class="s1">&#39;tweakreg&#39;</span><span class="p">],</span> <span class="n">image3dict</span><span class="p">[</span><span class="s1">&#39;skymatch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">image3dict</span><span class="p">[</span><span class="s1">&#39;outlier_detection&#39;</span><span class="p">],</span> <span class="n">image3dict</span><span class="p">[</span><span class="s1">&#39;resample&#39;</span><span class="p">],</span> <span class="n">image3dict</span><span class="p">[</span><span class="s1">&#39;source_catalog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>

<span class="c1"># Overrides for whether or not certain steps should be skipped (example)</span>
<span class="c1">#image3dict[&#39;outlier_detection&#39;][&#39;skip&#39;] = True</span>

<span class="c1"># Overrides for various reference files</span>
<span class="c1"># Files should be in the base local directory or provide full path</span>
<span class="c1">#image3dict[&#39;source_catalog&#39;][&#39;override_apcorr&#39;] = &#39;myfile.fits&#39;  # Aperture correction parameters</span>
<span class="c1">#image3dict[&#39;source_catalog&#39;][&#39;override_abvegaoffset&#39;] = &#39;myfile.asdf&#39;  # Data to convert from AB to Vega magnitudes (ASDF file)</span>

<span class="c1"># Overrides for specific parameters in the step (examples)</span>
<span class="c1">#image3dict[&#39;resample&#39;][&#39;weight_type&#39;] = [&#39;exptime&#39;]</span>
<span class="c1">#image3dict[&#39;outlier_detection&#39;][&#39;scale&#39;] = [&#39;1.0 0.8&#39;]</span>
</pre></div>
</div>
</div>
</div>
<p>Find and sort all of the input files, ensuring use of absolute paths</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Science Files need are the cal.fits files</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image2_dir</span><span class="p">,</span> <span class="s1">&#39;jw*cal.fits&#39;</span><span class="p">)</span>
<span class="n">cal_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cal_files</span><span class="p">)):</span>
    <span class="n">cal_files</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">cal_files</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
<span class="n">calfiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cal_files</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cal_files</span><span class="p">))</span><span class="si">}</span><span class="s1"> science files to process&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 5 science files to process
</pre></div>
</div>
</div>
</div>
<section id="create-association-file">
<h3>Create Association File<a class="headerlink" href="#create-association-file" title="Link to this heading">#</a></h3>
<p>An association file lists the exposures to calibrated together in <code class="docutils literal notranslate"><span class="pre">Stage3</span></code>
of the pipeline. Note that an association file is available for download
from MAST, with a filename of <code class="docutils literal notranslate"><span class="pre">*_asn.json</span></code>. Here we show how to create an
association file to point to the data products created when processing data
through the pipeline. Note that the output products will have a rootname
that is specified by the <code class="docutils literal notranslate"><span class="pre">product_name</span></code> in the association file. For
this tutorial, the rootname of the output products will be
<code class="docutils literal notranslate"><span class="pre">image3_association</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a Level 3 Association</span>
<span class="k">if</span> <span class="n">doimage3</span><span class="p">:</span>
    <span class="n">associations</span> <span class="o">=</span> <span class="n">afl</span><span class="o">.</span><span class="n">asn_from_list</span><span class="p">(</span><span class="n">cal_files</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="n">DMS_Level3_Base</span><span class="p">,</span> <span class="n">product_name</span><span class="o">=</span><span class="s1">&#39;image3_association&#39;</span><span class="p">)</span>

    <span class="n">associations</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;asn_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;image3&#39;</span>
    <span class="n">program</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">cal_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">observation</span><span class="o">.</span><span class="n">program_number</span>
    <span class="n">associations</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;program&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">program</span>

    <span class="c1"># Format association as .json file</span>
    <span class="n">asn_filename</span><span class="p">,</span> <span class="n">serialized</span> <span class="o">=</span> <span class="n">associations</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>

    <span class="c1"># Write out association file</span>
    <span class="n">association_im3</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_dir</span><span class="p">,</span> <span class="n">asn_filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">association_im3</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">serialized</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1782
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-image3-stage-of-the-pipeline">
<h3>Run Image3 stage of the pipeline<a class="headerlink" href="#run-image3-stage-of-the-pipeline" title="Link to this heading">#</a></h3>
<p>Given the grouped exposures in the association file, the products if the
<code class="docutils literal notranslate"><span class="pre">Image3</span></code> stage of the pipeline are:</p>
<ul class="simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">*_crf.fits</span></code> file produced by the <code class="docutils literal notranslate"><span class="pre">outlier_detection</span></code> step, where the <code class="docutils literal notranslate"><span class="pre">DQ</span></code> array marks the pixels flagged as outliers.</p></li>
<li><p>a final combined, rectified image with name <code class="docutils literal notranslate"><span class="pre">*_i2d.fits</span></code>,</p></li>
<li><p>a source catalog with name <code class="docutils literal notranslate"><span class="pre">*_cat.ecsv</span></code>,</p></li>
<li><p>a segmentation map file (<code class="docutils literal notranslate"><span class="pre">*_segm.fits</span></code>) which has integer values at the pixel locations where a source is detected where the pixel values match the source ID number in the catalog.</p></li>
</ul>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Stage 3</span>
<span class="k">if</span> <span class="n">doimage3</span><span class="p">:</span>
    <span class="n">i2d_result</span> <span class="o">=</span> <span class="n">Image3Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">association_im3</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">image3_dir</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">image3dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping Spec3 processing&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,932 - stpipe - INFO - PARS-TWEAKREGSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-tweakregstep_0020.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,943 - stpipe - INFO - PARS-OUTLIERDETECTIONSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-outlierdetectionstep_0096.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,952 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,960 - stpipe - INFO - PARS-SOURCECATALOGSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-sourcecatalogstep_0018.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,974 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,975 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,978 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,979 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,981 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,982 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:34,983 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:35,141 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./mir_im_demo_data/Obs001/jw01040-a3001_image3_00007_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:35,153 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./mir_im_demo_data/Obs001/stage3
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      kernel_fwhm: 2.19
      bkg_boxsize: 400
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.5
      sharphi: 2.0
      roundlo: 0.0
      roundhi: 0.2
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3
      searchrad: 1.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      skylist: None
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: exptime
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      maskpt: 0.7
      snr: 4.0 3.0
      scale: 1.0 0.8
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE+NON_SCIENCE
      in_memory: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.27
      snr_threshold: 3.0
      npixels: 5
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:35,216 - stpipe.Image3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01040-a3001_image3_00007_asn.json&#39; reftypes = [&#39;abvegaoffset&#39;, &#39;apcorr&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:35,219 - stpipe.Image3Pipeline - INFO - Prefetch for ABVEGAOFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_abvegaoffset_0002.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:35,219 - stpipe.Image3Pipeline - INFO - Prefetch for APCORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_apcorr_0014.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:35,220 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:35,621 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f9d346348d0&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:35,983 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 97 sources in jw01040001005_03103_00001_mirimage_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:36,470 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 90 sources in jw01040001005_03103_00002_mirimage_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:36,949 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 92 sources in jw01040001005_03103_00003_mirimage_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:37,427 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 89 sources in jw01040001005_03103_00004_mirimage_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:37,903 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 97 sources in jw01040001005_03103_00005_mirimage_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:37,924 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:37,925 - stpipe.Image3Pipeline.tweakreg - INFO - Number of image groups to be aligned: 5.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:37,925 - tweakwcs.imalign - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:37,926 - tweakwcs.imalign - INFO - ***** tweakwcs.imalign.align_wcs() started on 2025-11-19 20:27:37.925636
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:37,926 - tweakwcs.imalign - INFO -       Version 0.8.12
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:37,927 - tweakwcs.imalign - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,207 - tweakwcs.imalign - INFO - Selected image &#39;GROUP ID: jw01040001005_03103_1&#39; as reference image
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,211 - tweakwcs.imalign - INFO - Aligning image catalog &#39;GROUP ID: jw01040001005_03103_2&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,257 - tweakwcs.matchutils - INFO - Matching sources from &#39;jw01040001005_03103_00002_mirimage_cal&#39; catalog with sources from the reference &#39;jw01040001005_03103_00001_mirimage_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,258 - tweakwcs.matchutils - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,259 - tweakwcs.matchutils - INFO - Found initial X and Y shifts of 0.1091, 0.1091 (arcsec) with significance of 68 and 68 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,260 - tweakwcs.wcsimage - INFO - Found 67 matches for &#39;GROUP ID: jw01040001005_03103_2&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,261 - tweakwcs.linearfit - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,263 - tweakwcs.wcsimage - INFO - Computed &#39;rshift&#39; fit for GROUP ID: jw01040001005_03103_2:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,263 - tweakwcs.wcsimage - INFO - XSH: -0.00430263  YSH: -0.000731216    ROT: 0.00134208    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,264 - tweakwcs.wcsimage - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,264 - tweakwcs.wcsimage - INFO - FIT RMSE: 0.0145465   FIT MAE: 0.0134298
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,265 - tweakwcs.wcsimage - INFO - Final solution based on 67 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,296 - tweakwcs.imalign - INFO - Aligning image catalog &#39;GROUP ID: jw01040001005_03103_3&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,341 - tweakwcs.matchutils - INFO - Matching sources from &#39;jw01040001005_03103_00003_mirimage_cal&#39; catalog with sources from the reference &#39;jw01040001005_03103_00001_mirimage_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,341 - tweakwcs.matchutils - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,343 - tweakwcs.matchutils - INFO - Found initial X and Y shifts of 0.1091, 0.1091 (arcsec) with significance of 69 and 69 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,344 - tweakwcs.wcsimage - INFO - Found 68 matches for &#39;GROUP ID: jw01040001005_03103_3&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,345 - tweakwcs.linearfit - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,346 - tweakwcs.wcsimage - INFO - Computed &#39;rshift&#39; fit for GROUP ID: jw01040001005_03103_3:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,347 - tweakwcs.wcsimage - INFO - XSH: -0.00584086  YSH: -0.00174599    ROT: 0.000139988    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,348 - tweakwcs.wcsimage - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,348 - tweakwcs.wcsimage - INFO - FIT RMSE: 0.0130717   FIT MAE: 0.011891
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,349 - tweakwcs.wcsimage - INFO - Final solution based on 68 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,379 - tweakwcs.imalign - INFO - Aligning image catalog &#39;GROUP ID: jw01040001005_03103_4&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,423 - tweakwcs.matchutils - INFO - Matching sources from &#39;jw01040001005_03103_00004_mirimage_cal&#39; catalog with sources from the reference &#39;jw01040001005_03103_00001_mirimage_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,423 - tweakwcs.matchutils - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,425 - tweakwcs.matchutils - INFO - Found initial X and Y shifts of 0.1091, 0.1091 (arcsec) with significance of 60 and 60 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,426 - tweakwcs.wcsimage - INFO - Found 59 matches for &#39;GROUP ID: jw01040001005_03103_4&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,426 - tweakwcs.linearfit - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,428 - tweakwcs.wcsimage - INFO - Computed &#39;rshift&#39; fit for GROUP ID: jw01040001005_03103_4:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,429 - tweakwcs.wcsimage - INFO - XSH: -0.00880372  YSH: -0.00263095    ROT: 0.00459673    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,429 - tweakwcs.wcsimage - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,430 - tweakwcs.wcsimage - INFO - FIT RMSE: 0.0141322   FIT MAE: 0.0122104
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,430 - tweakwcs.wcsimage - INFO - Final solution based on 59 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,461 - tweakwcs.imalign - INFO - Aligning image catalog &#39;GROUP ID: jw01040001005_03103_5&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,506 - tweakwcs.matchutils - INFO - Matching sources from &#39;jw01040001005_03103_00005_mirimage_cal&#39; catalog with sources from the reference &#39;jw01040001005_03103_00001_mirimage_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,506 - tweakwcs.matchutils - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,508 - tweakwcs.matchutils - INFO - Found initial X and Y shifts of 0.1091, 0.1091 (arcsec) with significance of 65 and 65 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,509 - tweakwcs.wcsimage - INFO - Found 63 matches for &#39;GROUP ID: jw01040001005_03103_5&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,510 - tweakwcs.linearfit - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,511 - tweakwcs.wcsimage - INFO - Computed &#39;rshift&#39; fit for GROUP ID: jw01040001005_03103_5:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,512 - tweakwcs.wcsimage - INFO - XSH: -0.00683569  YSH: -0.00371656    ROT: -0.000710487    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,512 - tweakwcs.wcsimage - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,513 - tweakwcs.wcsimage - INFO - FIT RMSE: 0.0124526   FIT MAE: 0.0105718
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,513 - tweakwcs.wcsimage - INFO - Final solution based on 63 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,544 - tweakwcs.imalign - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,544 - tweakwcs.imalign - INFO - ***** tweakwcs.imalign.align_wcs() ended on 2025-11-19 20:27:38.544619
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,545 - tweakwcs.imalign - INFO - ***** tweakwcs.imalign.align_wcs() TOTAL RUN TIME: 0:00:00.618983
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,545 - tweakwcs.imalign - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,616 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.519756096 -69.441178981 80.538579735 -69.471753838 80.626144221 -69.465134413 80.607977234 -69.434457593
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,655 - py.warnings - WARNING - /home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/gwcs/wcs/_wcs.py:1790: LinAlgWarning: Failed to achieve requested SIP approximation accuracy.
  fit_inv_poly_u, fit_inv_poly_v, max_inv_resid = fit_2D_poly(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,712 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.517105846 -69.438900240 80.535925744 -69.469475230 80.623481314 -69.462856423 80.605318017 -69.432179474
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,751 - py.warnings - WARNING - /home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/gwcs/wcs/_wcs.py:1790: LinAlgWarning: Failed to achieve requested SIP approximation accuracy.
  fit_inv_poly_u, fit_inv_poly_v, max_inv_resid = fit_2D_poly(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,809 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.513331520 -69.439820350 80.532140011 -69.470396265 80.619701993 -69.463781765 80.601550154 -69.433103923
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:38,847 - py.warnings - WARNING - /home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/gwcs/wcs/_wcs.py:1790: LinAlgWarning: Failed to achieve requested SIP approximation accuracy.
  fit_inv_poly_u, fit_inv_poly_v, max_inv_resid = fit_2D_poly(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,079 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.515616620 -69.443456967 80.534439624 -69.474032024 80.622013978 -69.467413524 80.603847687 -69.436736512
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,118 - py.warnings - WARNING - /home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/gwcs/wcs/_wcs.py:1790: LinAlgWarning: Failed to achieve requested SIP approximation accuracy.
  fit_inv_poly_u, fit_inv_poly_v, max_inv_resid = fit_2D_poly(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,135 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,298 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f9d346348d0&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,388 - stcal.skymatch.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,389 - stcal.skymatch.skymatch - INFO - ***** stcal.skymatch.skymatch.skymatch() started on 2025-11-19 20:27:39.388442
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,389 - stcal.skymatch.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,390 - stcal.skymatch.skymatch - INFO - Sky computation method: &#39;match&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,390 - stcal.skymatch.skymatch - INFO - Sky matching direction: DOWN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,391 - stcal.skymatch.skymatch - INFO - Sky subtraction from image data: OFF
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,392 - stcal.skymatch.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:39,392 - stcal.skymatch.skymatch - INFO - ----  Computing differences in sky values in overlapping regions.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,782 - stcal.skymatch.skymatch - INFO -    *  Image ID=jw01040001005_03103_00001_mirimage_cal.fits. Sky background: 0.0203066
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,783 - stcal.skymatch.skymatch - INFO -    *  Image ID=jw01040001005_03103_00002_mirimage_cal.fits. Sky background: 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,784 - stcal.skymatch.skymatch - INFO -    *  Image ID=jw01040001005_03103_00003_mirimage_cal.fits. Sky background: 0.0248103
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,784 - stcal.skymatch.skymatch - INFO -    *  Image ID=jw01040001005_03103_00004_mirimage_cal.fits. Sky background: 0.00271931
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,784 - stcal.skymatch.skymatch - INFO -    *  Image ID=jw01040001005_03103_00005_mirimage_cal.fits. Sky background: 0.0137427
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,786 - stcal.skymatch.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,786 - stcal.skymatch.skymatch - INFO - ***** stcal.skymatch.skymatch.skymatch() ended on 2025-11-19 20:27:40.786013
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,787 - stcal.skymatch.skymatch - INFO - ***** stcal.skymatch.skymatch.skymatch() TOTAL RUN TIME: 0:00:01.397571
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,787 - stcal.skymatch.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,802 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,977 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f9d346348d0&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,978 - stpipe.Image3Pipeline.outlier_detection - INFO - Outlier Detection mode: imaging
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:40,979 - stpipe.Image3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,000 - jwst.resample.resample_utils - INFO - Pixel scale ratio (pscale_out/pscale_in): 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,001 - jwst.resample.resample_utils - INFO - Computed output pixel scale: 0.11091590874981953 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,016 - stcal.resample.resample - INFO - Output pixel scale: 0.11091590874981953 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,017 - stcal.resample.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,018 - stcal.resample.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,018 - stcal.resample.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,019 - stcal.resample.resample - INFO - Driz parameter weight_type: exptime
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,020 - jwst.resample.resample - INFO - 1 exposures to drizzle together
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,478 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,784 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.512843494 -69.439087442 80.534017190 -69.474046113 80.629901790 -69.466865561 80.608579256 -69.431918568
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:41,817 - jwst.resample.resample - INFO - 1 exposures to drizzle together
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:42,422 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:42,724 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.512843494 -69.439087442 80.534017190 -69.474046113 80.629901790 -69.466865561 80.608579256 -69.431918568
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:42,754 - jwst.resample.resample - INFO - 1 exposures to drizzle together
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:43,358 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:43,659 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.512843494 -69.439087442 80.534017190 -69.474046113 80.629901790 -69.466865561 80.608579256 -69.431918568
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:43,689 - jwst.resample.resample - INFO - 1 exposures to drizzle together
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:44,287 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:44,589 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.512843494 -69.439087442 80.534017190 -69.474046113 80.629901790 -69.466865561 80.608579256 -69.431918568
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:44,618 - jwst.resample.resample - INFO - 1 exposures to drizzle together
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:45,223 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:45,523 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.512843494 -69.439087442 80.534017190 -69.474046113 80.629901790 -69.466865561 80.608579256 -69.431918568
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:46,809 - stcal.outlier_detection.utils - INFO - Blotting (1024, 1032) &lt;-- (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:46,895 - jwst.outlier_detection.utils - INFO - 237 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:47,552 - stcal.outlier_detection.utils - INFO - Blotting (1024, 1032) &lt;-- (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:47,625 - jwst.outlier_detection.utils - INFO - 217 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:48,286 - stcal.outlier_detection.utils - INFO - Blotting (1024, 1032) &lt;-- (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:48,358 - jwst.outlier_detection.utils - INFO - 170 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:49,004 - stcal.outlier_detection.utils - INFO - Blotting (1024, 1032) &lt;-- (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:49,076 - jwst.outlier_detection.utils - INFO - 209 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:49,725 - stcal.outlier_detection.utils - INFO - Blotting (1024, 1032) &lt;-- (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:49,799 - jwst.outlier_detection.utils - INFO - 153 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:49,957 - stpipe.Image3Pipeline.outlier_detection - INFO - Saved model in ./mir_im_demo_data/Obs001/stage3/jw01040001005_03103_00001_mirimage_a3001_crf.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,111 - stpipe.Image3Pipeline.outlier_detection - INFO - Saved model in ./mir_im_demo_data/Obs001/stage3/jw01040001005_03103_00002_mirimage_a3001_crf.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,264 - stpipe.Image3Pipeline.outlier_detection - INFO - Saved model in ./mir_im_demo_data/Obs001/stage3/jw01040001005_03103_00003_mirimage_a3001_crf.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,417 - stpipe.Image3Pipeline.outlier_detection - INFO - Saved model in ./mir_im_demo_data/Obs001/stage3/jw01040001005_03103_00004_mirimage_a3001_crf.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,574 - stpipe.Image3Pipeline.outlier_detection - INFO - Saved model in ./mir_im_demo_data/Obs001/stage3/jw01040001005_03103_00005_mirimage_a3001_crf.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,575 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,742 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f9d346348d0&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,799 - jwst.resample.resample_utils - INFO - Pixel scale ratio (pscale_out/pscale_in): 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,800 - jwst.resample.resample_utils - INFO - Computed output pixel scale: 0.11091590874981953 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,815 - stcal.resample.resample - INFO - Output pixel scale: 0.11091590874981953 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,816 - stcal.resample.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,816 - stcal.resample.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,817 - stcal.resample.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,817 - stcal.resample.resample - INFO - Driz parameter weight_type: exptime
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:50,823 - jwst.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:51,264 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:51,508 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:51,704 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:51,902 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:52,771 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:53,016 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:53,212 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:53,409 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:54,221 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:54,465 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:54,661 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:54,859 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:55,675 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:55,919 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:56,115 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:56,313 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:57,129 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:57,379 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:57,582 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:57,781 - stcal.resample.resample - INFO - Drizzling (1024, 1032) --&gt; (1160, 1116)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,215 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  80.512843494 -69.439087442 80.534017190 -69.474046113 80.629901790 -69.466865561 80.608579256 -69.431918568
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,443 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./mir_im_demo_data/Obs001/stage3/image3_association_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,444 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,623 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1160, 1116) from image3_association_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,650 - stpipe.Image3Pipeline.source_catalog - INFO - Using APCORR reference file: /home/runner/crds/references/jwst/miri/jwst_miri_apcorr_0014.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,653 - stpipe.Image3Pipeline.source_catalog - INFO - Using ABVEGAOFFSET reference file: /home/runner/crds/references/jwst/miri/jwst_miri_abvegaoffset_0002.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,653 - jwst.source_catalog.reference_data - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,654 - jwst.source_catalog.reference_data - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,655 - jwst.source_catalog.reference_data - INFO - Filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,655 - jwst.source_catalog.reference_data - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,693 - jwst.source_catalog.reference_data - INFO - AB to Vega magnitude offset 4.38398
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,809 - jwst.source_catalog.detection - INFO - Background could not be estimated in meshes. Using the entire unmasked array for background estimation: bkg_boxsize=(1160, 1116).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:58,922 - jwst.source_catalog.detection - INFO - Detected 705 sources
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:59,466 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote source catalog: ./mir_im_demo_data/Obs001/stage3/image3_association_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:59,563 - stpipe.Image3Pipeline.source_catalog - INFO - Saved model in ./mir_im_demo_data/Obs001/stage3/image3_association_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:59,564 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote segmentation map: image3_association_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:59,565 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:59,574 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-11-19 20:27:59,574 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the time benchmark</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime so far: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="si">:</span><span class="s2">0.0f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime for Image3: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time_image3</span><span class="si">:</span><span class="s2">0.0f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Runtime so far: 108 seconds
Runtime for Image3: 25 seconds
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>Verify which pipeline steps were run and reference files used<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">doimage3</span><span class="p">:</span>
    <span class="c1"># Identify *_i2d file and open as datamodel</span>
    <span class="n">i2d</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image3_dir</span><span class="p">,</span> <span class="s2">&quot;*_i2d.fits&quot;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">i2d_f</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">i2d</span><span class="p">)</span>

    <span class="c1"># Check which steps were run</span>
    <span class="n">i2d_f</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">cal_step</span><span class="o">.</span><span class="n">instance</span>

    <span class="c1"># Check which reference files were used to calibrate the dataset</span>
    <span class="n">i2d_f</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">ref_file</span><span class="o">.</span><span class="n">instance</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;assign_wcs&#39;: &#39;COMPLETE&#39;,
 &#39;charge_migration&#39;: &#39;SKIPPED&#39;,
 &#39;clean_flicker_noise&#39;: &#39;SKIPPED&#39;,
 &#39;dark_sub&#39;: &#39;COMPLETE&#39;,
 &#39;dq_init&#39;: &#39;COMPLETE&#39;,
 &#39;emicorr&#39;: &#39;COMPLETE&#39;,
 &#39;firstframe&#39;: &#39;COMPLETE&#39;,
 &#39;flat_field&#39;: &#39;COMPLETE&#39;,
 &#39;gain_scale&#39;: &#39;SKIPPED&#39;,
 &#39;group_scale&#39;: &#39;SKIPPED&#39;,
 &#39;ipc&#39;: &#39;SKIPPED&#39;,
 &#39;jump&#39;: &#39;COMPLETE&#39;,
 &#39;lastframe&#39;: &#39;COMPLETE&#39;,
 &#39;linearity&#39;: &#39;COMPLETE&#39;,
 &#39;outlier_detection&#39;: &#39;COMPLETE&#39;,
 &#39;photom&#39;: &#39;COMPLETE&#39;,
 &#39;ramp_fit&#39;: &#39;COMPLETE&#39;,
 &#39;refpix&#39;: &#39;SKIPPED&#39;,
 &#39;resample&#39;: &#39;COMPLETE&#39;,
 &#39;reset&#39;: &#39;COMPLETE&#39;,
 &#39;rscd&#39;: &#39;COMPLETE&#39;,
 &#39;saturation&#39;: &#39;COMPLETE&#39;,
 &#39;skymatch&#39;: &#39;COMPLETE&#39;,
 &#39;tweakreg&#39;: &#39;COMPLETE&#39;}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;area&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_area_0006.fits&#39;},
 &#39;camera&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;collimator&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;crds&#39;: {&#39;context_used&#39;: &#39;jwst_1413.pmap&#39;, &#39;sw_version&#39;: &#39;13.0.6&#39;},
 &#39;dark&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_dark_0113.fits&#39;},
 &#39;dflat&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;disperser&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;distortion&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_distortion_0047.asdf&#39;},
 &#39;emicorr&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_emicorr_0003.asdf&#39;},
 &#39;fflat&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;filteroffset&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_filteroffset_0008.asdf&#39;},
 &#39;flat&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_flat_0829.fits&#39;},
 &#39;fore&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;fpa&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;gain&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_gain_0034.fits&#39;},
 &#39;ifufore&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;ifupost&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;ifuslicer&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;linearity&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_linearity_0032.fits&#39;},
 &#39;mask&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_mask_0036.fits&#39;},
 &#39;msa&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;ote&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;photom&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_photom_0218.fits&#39;},
 &#39;readnoise&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_readnoise_0085.fits&#39;},
 &#39;regions&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;reset&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_reset_0077.fits&#39;},
 &#39;rscd&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_rscd_0017.fits&#39;},
 &#39;saturation&#39;: {&#39;name&#39;: &#39;crds://jwst_miri_saturation_0034.fits&#39;},
 &#39;sflat&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;specwcs&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;superbias&#39;: {&#39;name&#39;: &#39;N/A&#39;},
 &#39;wavelengthrange&#39;: {&#39;name&#39;: &#39;N/A&#39;}}
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
</section>
<section id="visualize-the-drizzle-combined-image">
<h2>8. Visualize the drizzle-combined image<a class="headerlink" href="#visualize-the-drizzle-combined-image" title="Link to this heading">#</a></h2>
<p>We will use matplotlib routines for visualizing the data. Display the combined i2d image.</p>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">doviz</span><span class="p">:</span>
    <span class="c1"># Look at the final i2d image (combined mosaic)</span>
    <span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image3_dir</span><span class="p">,</span> <span class="s1">&#39;*i2d.fits&#39;</span><span class="p">)</span>
    <span class="n">miri_mosaic_file</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">miri_mosaic_file</span><span class="p">)</span>

    <span class="c1"># Read your mosaic image into an ImageModel datamodel</span>
    <span class="n">miri_mosaic</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">miri_mosaic_file</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c1"># Autoscale the stretch</span>
    <span class="n">display_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">miri_mosaic</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">miri_mosaic</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">99</span><span class="p">)]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Set up image</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">miri_mosaic</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">display_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="n">display_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Set up colorbar</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;MJy/str&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="c1"># Set labels </span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Final MIRI mosaic&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mir_im_demo_data/Obs001/stage3/image3_association_i2d.fits&#39;]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 800x800 with 0 Axes&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;MJy/str&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;X&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Y&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Final MIRI mosaic&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 800x800 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../../../_images/e790ee1dd7f91b4e0dee12e7d6d57e04451459c1fc5a8e3b40c8d1dbe09a327d.png" src="../../../_images/e790ee1dd7f91b4e0dee12e7d6d57e04451459c1fc5a8e3b40c8d1dbe09a327d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_vals</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[np.float32(4.089625), np.float32(5.5585766)]
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-detected-sources">
<h2><a id='detections'>Visualize Detected Sources</a><a class="headerlink" href="#visualize-detected-sources" title="Link to this heading">#</a></h2>
<p>Using the source catalog created by the <code class="docutils literal notranslate"><span class="pre">IMAGE3</span></code> stage of the pipeline,
mark the detected sources, using different markers for point sources
and extended sources. The source catalog is saved in
<code class="docutils literal notranslate"><span class="pre">image3/image3_association_cat.ecsv</span></code> file.</p>
<section id="read-in-catalog-file-and-identify-point-extended-sources">
<h3>Read in catalog file and identify point/extended sources<a class="headerlink" href="#read-in-catalog-file-and-identify-point-extended-sources" title="Link to this heading">#</a></h3>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">doviz</span><span class="p">:</span>
    <span class="n">catalog_file</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image3_dir</span><span class="p">,</span> <span class="s2">&quot;*_cat.ecsv&quot;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">catalog_file</span><span class="p">)</span>

    <span class="c1"># find where sources are considered extended or point sources</span>
    <span class="n">pt_src</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;is_extended&#39;</span><span class="p">])</span>
    <span class="n">ext_src</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;is_extended&#39;</span><span class="p">])</span>

    <span class="c1"># Get x and y coordinates of the objects found </span>
    <span class="n">miri_x</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">][</span><span class="n">pt_src</span><span class="p">]</span>
    <span class="n">miri_y</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">][</span><span class="n">pt_src</span><span class="p">]</span>

    <span class="n">ext_x</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">][</span><span class="n">ext_src</span><span class="p">]</span>
    <span class="n">ext_y</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">][</span><span class="n">ext_src</span><span class="p">]</span>

    <span class="c1"># Show catalog</span>
    <span class="n">catalog</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=705</i>
<table id="table140313124127760" class="table-striped table-bordered table-condensed">
<thead><tr><th>label</th><th>xcentroid</th><th>ycentroid</th><th>sky_centroid</th><th>aper_bkg_flux</th><th>aper_bkg_flux_err</th><th>aper30_flux</th><th>aper30_flux_err</th><th>aper50_flux</th><th>aper50_flux_err</th><th>aper70_flux</th><th>aper70_flux_err</th><th>aper_total_flux</th><th>aper_total_flux_err</th><th>aper30_abmag</th><th>aper30_abmag_err</th><th>aper50_abmag</th><th>aper50_abmag_err</th><th>aper70_abmag</th><th>aper70_abmag_err</th><th>aper_total_abmag</th><th>aper_total_abmag_err</th><th>aper30_vegamag</th><th>aper30_vegamag_err</th><th>aper50_vegamag</th><th>aper50_vegamag_err</th><th>aper70_vegamag</th><th>aper70_vegamag_err</th><th>aper_total_vegamag</th><th>aper_total_vegamag_err</th><th>CI_50_30</th><th>CI_70_50</th><th>CI_70_30</th><th>is_extended</th><th>sharpness</th><th>roundness</th><th>nn_label</th><th>nn_dist</th><th>isophotal_flux</th><th>isophotal_flux_err</th><th>isophotal_abmag</th><th>isophotal_abmag_err</th><th>isophotal_vegamag</th><th>isophotal_vegamag_err</th><th>isophotal_area</th><th>semimajor_sigma</th><th>semiminor_sigma</th><th>ellipticity</th><th>orientation</th><th>sky_orientation</th><th>sky_bbox_ll</th><th>sky_bbox_ul</th><th>sky_bbox_lr</th><th>sky_bbox_ur</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th>deg,deg</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>pix</th><th>Jy</th><th>Jy</th><th></th><th></th><th></th><th></th><th>pix2</th><th>pix</th><th>pix</th><th></th><th>deg</th><th>deg</th><th>deg,deg</th><th>deg,deg</th><th>deg,deg</th><th>deg,deg</th></tr></thead>
<thead><tr><th>int32</th><th>float64</th><th>float64</th><th>SkyCoord</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>bool</th><th>float64</th><th>float32</th><th>int32</th><th>float64</th><th>float64</th><th>float32</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>SkyCoord</th><th>SkyCoord</th><th>SkyCoord</th><th>SkyCoord</th></tr></thead>
<tr><td>1</td><td>565.2549</td><td>14.4137</td><td>80.56165735947239,-69.43590915581524</td><td>2.135599e-08</td><td>5.627136e-09</td><td>1.477625e-05</td><td>2.609391e-07</td><td>2.869221e-05</td><td>3.854329e-07</td><td>4.774304e-05</td><td>6.700192e-07</td><td>6.885998e-05</td><td>9.663716e-07</td><td>20.976089</td><td>0.019006</td><td>20.255590</td><td>0.014488</td><td>19.702725</td><td>0.015131</td><td>19.305083</td><td>0.015131</td><td>16.592109</td><td>0.019006</td><td>15.871610</td><td>0.014488</td><td>15.318745</td><td>0.015131</td><td>14.921103</td><td>0.015131</td><td>1.9418</td><td>1.6640</td><td>3.2311</td><td>False</td><td>0.226591</td><td>1.603836</td><td>7</td><td>24.667159</td><td>6.061346e-05</td><td>8.536932e-07</td><td>19.443577</td><td>0.015185</td><td>15.059597</td><td>0.015185</td><td>96.0</td><td>2.955318</td><td>1.650560</td><td>0.441495</td><td>62.906187</td><td>320.862340</td><td>80.56103723043908,-69.43573779668367</td><td>80.56127498171776,-69.4361295234562</td><td>80.56206665354586,-69.43566070706972</td><td>80.56230442273437,-69.4360524324372</td></tr>
<tr><td>2</td><td>605.1704</td><td>8.7669</td><td>80.56497821428461,-69.43548254664304</td><td>3.034837e-08</td><td>7.038789e-09</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>nan</td><td>nan</td><td>5</td><td>13.644258</td><td>2.050962e-06</td><td>2.268761e-07</td><td>23.120106</td><td>0.113913</td><td>18.736126</td><td>0.113913</td><td>8.0</td><td>0.808785</td><td>0.687845</td><td>0.149534</td><td>45.430000</td><td>303.386153</td><td>80.56481174572897,-69.43545510502864</td><td>80.5648849192506,-69.43557563479227</td><td>80.56515487855927,-69.43542940173224</td><td>80.56522805391762,-69.43554993135173</td></tr>
<tr><td>3</td><td>1066.5938</td><td>10.7844</td><td>80.60459221557207,-69.43257380940443</td><td>4.756915e-08</td><td>7.975070e-09</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>nan</td><td>nan</td><td>6</td><td>6.947139</td><td>7.933763e-07</td><td>1.833290e-07</td><td>24.151302</td><td>0.225711</td><td>19.767322</td><td>0.225711</td><td>5.0</td><td>0.779008</td><td>0.443822</td><td>0.430272</td><td>70.823373</td><td>328.779526</td><td>80.60447484843624,-69.43254216271937</td><td>80.60454823441864,-69.43266267579226</td><td>80.60473212762793,-69.43252282672651</td><td>80.60480551498671,-69.43264333969091</td></tr>
<tr><td>4</td><td>791.4352</td><td>14.1301</td><td>80.58105397139425,-69.43444650532162</td><td>1.791873e-08</td><td>5.753170e-09</td><td>5.471495e-06</td><td>2.166655e-07</td><td>9.136369e-06</td><td>3.236250e-07</td><td>1.350058e-05</td><td>6.067353e-07</td><td>1.947195e-05</td><td>8.750970e-07</td><td>22.054735</td><td>0.042165</td><td>21.498066</td><td>0.037793</td><td>21.074119</td><td>0.047730</td><td>20.676477</td><td>0.047730</td><td>17.670755</td><td>0.042165</td><td>17.114086</td><td>0.037793</td><td>16.690139</td><td>0.047730</td><td>16.292497</td><td>0.047730</td><td>1.6698</td><td>1.4777</td><td>2.4674</td><td>False</td><td>0.612833</td><td>-0.138018</td><td>9</td><td>10.922342</td><td>1.264074e-05</td><td>4.831865e-07</td><td>21.145569</td><td>0.040728</td><td>16.761589</td><td>0.040728</td><td>34.0</td><td>1.440662</td><td>1.319030</td><td>0.084428</td><td>-55.789108</td><td>202.167045</td><td>80.58073572382544,-69.43435601274635</td><td>80.58088224279138,-69.43459705885498</td><td>80.58133614168793,-69.43431097665017</td><td>80.58148266708021,-69.43455202225364</td></tr>
<tr><td>5</td><td>617.9026</td><td>13.6718</td><td>80.56616015379018,-69.43554852263067</td><td>2.024294e-08</td><td>5.633569e-09</td><td>1.205345e-06</td><td>1.924078e-07</td><td>2.365828e-06</td><td>2.961119e-07</td><td>4.359931e-06</td><td>5.894469e-07</td><td>6.288347e-06</td><td>8.501617e-07</td><td>23.697222</td><td>0.160798</td><td>22.965042</td><td>0.128038</td><td>22.301301</td><td>0.137677</td><td>21.903659</td><td>0.137677</td><td>19.313242</td><td>0.160798</td><td>18.581062</td><td>0.128038</td><td>17.917321</td><td>0.137677</td><td>17.519679</td><td>0.137677</td><td>1.9628</td><td>1.8429</td><td>3.6172</td><td>False</td><td>0.288238</td><td>0.495850</td><td>2</td><td>13.644258</td><td>2.376658e-06</td><td>2.650625e-07</td><td>22.960083</td><td>0.114800</td><td>18.576103</td><td>0.114800</td><td>11.0</td><td>1.045422</td><td>0.752996</td><td>0.279720</td><td>75.995131</td><td>333.951283</td><td>80.56600010391784,-69.4354920961395</td><td>80.56609157943576,-69.43564275771543</td><td>80.56634323591763,-69.43546639050251</td><td>80.56643471373145,-69.43561705189822</td></tr>
<tr><td>6</td><td>1065.3737</td><td>17.6236</td><td>80.60461306066411,-69.43278772522945</td><td>3.401776e-08</td><td>6.639909e-09</td><td>3.827103e-06</td><td>2.164807e-07</td><td>5.340309e-06</td><td>3.214883e-07</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>22.442825</td><td>0.059741</td><td>22.081084</td><td>0.063470</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>18.058845</td><td>0.059741</td><td>17.697104</td><td>0.063470</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.3954</td><td>nan</td><td>nan</td><td>False</td><td>0.389282</td><td>nan</td><td>3</td><td>6.947139</td><td>6.315297e-06</td><td>3.719940e-07</td><td>21.899016</td><td>0.062141</td><td>17.515036</td><td>0.062141</td><td>19.0</td><td>1.138851</td><td>1.032484</td><td>0.093399</td><td>25.520352</td><td>283.476505</td><td>80.6043276459992,-69.43274226809272</td><td>80.6044377250683,-69.43292303778397</td><td>80.60484220897465,-69.43270359616159</td><td>80.6049522921728,-69.43288436552744</td></tr>
<tr><td>7</td><td>541.6894</td><td>21.7032</td><td>80.55976905775438,-69.43628018835581</td><td>1.926328e-08</td><td>4.804349e-09</td><td>1.353692e-06</td><td>1.944472e-07</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>23.571201</td><td>0.145725</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>19.187221</td><td>0.145725</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>nan</td><td>nan</td><td>11</td><td>16.945230</td><td>7.742785e-06</td><td>4.592082e-07</td><td>21.677757</td><td>0.062556</td><td>17.293777</td><td>0.062556</td><td>33.0</td><td>2.473988</td><td>1.008454</td><td>0.592377</td><td>8.915792</td><td>266.871945</td><td>80.55926529339474,-69.4362169981896</td><td>80.55937501121768,-69.4363977963184</td><td>80.56020895838877,-69.4361463425399</td><td>80.56031868378945,-69.43632714007435</td></tr>
<tr><td>8</td><td>658.0809</td><td>22.3145</td><td>80.56976490338103,-69.43555070830153</td><td>-1.817932e-08</td><td>3.585952e-09</td><td>4.165073e-06</td><td>2.076989e-07</td><td>6.690058e-06</td><td>3.124935e-07</td><td>9.915614e-06</td><td>5.997184e-07</td><td>1.430133e-05</td><td>8.649764e-07</td><td>22.350943</td><td>0.052836</td><td>21.836425</td><td>0.049566</td><td>21.409201</td><td>0.063758</td><td>21.011559</td><td>0.063758</td><td>17.966964</td><td>0.052836</td><td>17.452445</td><td>0.049566</td><td>17.025221</td><td>0.063758</td><td>16.627579</td><td>0.063758</td><td>1.6062</td><td>1.4821</td><td>2.3807</td><td>False</td><td>0.596213</td><td>0.761041</td><td>5</td><td>41.097377</td><td>7.504351e-06</td><td>3.805835e-07</td><td>21.711717</td><td>0.053712</td><td>17.327737</td><td>0.053712</td><td>21.0</td><td>1.206566</td><td>1.055660</td><td>0.125070</td><td>35.806792</td><td>293.762945</td><td>80.56949200316296,-69.43548249303822</td><td>80.56960180326236,-69.43566328472315</td><td>80.57000669435986,-69.43544392401299</td><td>80.57011649859166,-69.43562471537346</td></tr>
<tr><td>9</td><td>789.7568</td><td>24.9227</td><td>80.5811076761154,-69.43478249315326</td><td>1.263688e-08</td><td>3.820460e-09</td><td>5.710165e-06</td><td>2.192161e-07</td><td>1.023130e-05</td><td>3.276696e-07</td><td>1.681019e-05</td><td>5.927907e-07</td><td>2.424540e-05</td><td>8.549846e-07</td><td>22.008378</td><td>0.040902</td><td>21.375173</td><td>0.034227</td><td>20.836069</td><td>0.037628</td><td>20.438426</td><td>0.037628</td><td>17.624399</td><td>0.040902</td><td>16.991194</td><td>0.034227</td><td>16.452089</td><td>0.037628</td><td>16.054447</td><td>0.037628</td><td>1.7918</td><td>1.6430</td><td>2.9439</td><td>False</td><td>0.502781</td><td>-0.556190</td><td>4</td><td>10.922342</td><td>1.763360e-05</td><td>5.568799e-07</td><td>20.784147</td><td>0.033758</td><td>16.400168</td><td>0.033758</td><td>47.0</td><td>2.012710</td><td>1.337076</td><td>0.335684</td><td>-35.348373</td><td>222.607780</td><td>80.58066154689224,-69.43467662118421</td><td>80.58082638248288,-69.43494779811896</td><td>80.58151929894179,-69.43461228363535</td><td>80.58168414486079,-69.43488345975818</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>697</td><td>575.7960</td><td>1146.4017</td><td>80.58329912451543,-69.46995003865402</td><td>6.771949e-08</td><td>4.128105e-09</td><td>6.308764e-07</td><td>1.893037e-07</td><td>1.138031e-06</td><td>2.929553e-07</td><td>1.073450e-06</td><td>5.827915e-07</td><td>1.548242e-06</td><td>8.405627e-07</td><td>24.400139</td><td>0.284912</td><td>23.759615</td><td>0.248703</td><td>23.823045</td><td>0.470854</td><td>23.425403</td><td>0.470854</td><td>20.016160</td><td>0.284912</td><td>19.375635</td><td>0.248703</td><td>19.439065</td><td>0.470854</td><td>19.041423</td><td>0.470854</td><td>1.8039</td><td>0.9433</td><td>1.7015</td><td>False</td><td>0.448804</td><td>-0.383630</td><td>679</td><td>9.363685</td><td>9.671084e-07</td><td>1.768009e-07</td><td>23.936312</td><td>0.182291</td><td>19.552332</td><td>0.182291</td><td>5.0</td><td>0.758657</td><td>0.451520</td><td>0.404843</td><td>-18.253470</td><td>239.702683</td><td>80.58317122975623,-69.46993120992222</td><td>80.58322627533217,-69.47002160146005</td><td>80.58351489186508,-69.46990547046013</td><td>80.5835699388226,-69.46999586188953</td></tr>
<tr><td>698</td><td>966.1076</td><td>1149.2157</td><td>80.61688083594882,-69.4675199994777</td><td>1.108488e-07</td><td>4.861149e-09</td><td>1.730987e-07</td><td>1.939805e-07</td><td>2.899533e-07</td><td>3.017202e-07</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>25.804266</td><td>0.816165</td><td>25.244180</td><td>0.774385</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>21.420286</td><td>0.816165</td><td>20.860200</td><td>0.774385</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>1.6751</td><td>nan</td><td>nan</td><td>False</td><td>1.611624</td><td>nan</td><td>689</td><td>8.831272</td><td>1.548932e-06</td><td>2.434806e-07</td><td>23.424919</td><td>0.158514</td><td>19.040939</td><td>0.158514</td><td>9.0</td><td>1.838642</td><td>0.515941</td><td>0.719390</td><td>43.327630</td><td>301.283783</td><td>80.61660690078944,-69.46745500627163</td><td>80.61671726133397,-69.46763576820118</td><td>80.61712227389773,-69.4674162980355</td><td>80.61723263858397,-69.46759705963889</td></tr>
<tr><td>699</td><td>951.5752</td><td>1150.3874</td><td>80.61565410283931,-69.4676490485075</td><td>1.250354e-07</td><td>4.166960e-09</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>nan</td><td>nan</td><td>702</td><td>5.802521</td><td>1.642639e-06</td><td>2.452464e-07</td><td>23.361145</td><td>0.151084</td><td>18.977165</td><td>0.151084</td><td>9.0</td><td>1.043531</td><td>0.651341</td><td>0.375830</td><td>-5.207379</td><td>252.748774</td><td>80.6154411397238,-69.46760557380597</td><td>80.61551470718406,-69.46772608225852</td><td>80.61587062221024,-69.4675733199183</td><td>80.61594419197151,-69.4676938281897</td></tr>
<tr><td>700</td><td>601.4662</td><td>1152.7875</td><td>80.5856217651151,-69.46997724844019</td><td>8.517521e-08</td><td>5.462420e-09</td><td>5.538595e-07</td><td>1.875325e-07</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>24.541501</td><td>0.316621</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>20.157521</td><td>0.316621</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>nan</td><td>nan</td><td>693</td><td>7.356518</td><td>4.544518e-06</td><td>3.800020e-07</td><td>22.256280</td><td>0.087190</td><td>17.872301</td><td>0.087190</td><td>23.0</td><td>1.802814</td><td>1.073277</td><td>0.404666</td><td>-14.765726</td><td>243.190427</td><td>80.5852206804177,-69.4699037199855</td><td>80.58533078915818,-69.47008450175011</td><td>80.58590799801176,-69.46985223230996</td><td>80.58601811227838,-69.47003301364079</td></tr>
<tr><td>701</td><td>748.0078</td><td>1151.4257</td><td>80.59818632881938,-69.4689926233867</td><td>7.846477e-08</td><td>8.922376e-09</td><td>3.880110e-07</td><td>1.931248e-07</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>24.927890</td><td>0.438584</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>20.543910</td><td>0.438584</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>1.558405</td><td>nan</td><td>685</td><td>10.504169</td><td>9.669711e-07</td><td>1.825794e-07</td><td>23.936466</td><td>0.187786</td><td>19.552486</td><td>0.187786</td><td>5.0</td><td>1.328589</td><td>0.333422</td><td>0.749040</td><td>49.561613</td><td>307.517765</td><td>80.59802142899433,-69.4689443176004</td><td>80.59811327190796,-69.46909496233981</td><td>80.59836505746901,-69.46891854888595</td><td>80.59845690268455,-69.46906919344444</td></tr>
<tr><td>702</td><td>957.3724</td><td>1150.6353</td><td>80.61615662434015,-69.46761912022609</td><td>1.093764e-07</td><td>4.608765e-09</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>nan</td><td>nan</td><td>699</td><td>5.802521</td><td>1.249060e-06</td><td>2.317958e-07</td><td>23.658542</td><td>0.184824</td><td>19.274562</td><td>0.184824</td><td>8.0</td><td>1.308574</td><td>0.442771</td><td>0.661638</td><td>-8.820101</td><td>249.136052</td><td>80.6158890145731,-69.46760344698907</td><td>80.61594419197151,-69.4676938281897</td><td>80.61640439254222,-69.4675647408738</td><td>80.61645957201145,-69.46765512191133</td></tr>
<tr><td>703</td><td>867.2400</td><td>1151.6217</td><td>80.60843249199557,-69.46823011288248</td><td>2.594015e-08</td><td>6.554188e-09</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>nan</td><td>nan</td><td>687</td><td>8.802789</td><td>1.051243e-06</td><td>1.789142e-07</td><td>23.845742</td><td>0.170644</td><td>19.461762</td><td>0.170644</td><td>5.0</td><td>0.757644</td><td>0.450516</td><td>0.405373</td><td>-17.139709</td><td>240.816444</td><td>80.60826240517058,-69.4682075367663</td><td>80.60831755200313,-69.4682979203791</td><td>80.60860600953738,-69.46818174788014</td><td>80.6086611577507,-69.4682721313843</td></tr>
<tr><td>704</td><td>619.0560</td><td>1152.7933</td><td>80.58713309115984,-69.46986420667244</td><td>8.091279e-08</td><td>5.929797e-09</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>nan</td><td>nan</td><td>700</td><td>17.589799</td><td>2.665898e-06</td><td>2.903024e-07</td><td>22.835391</td><td>0.112226</td><td>18.451412</td><td>0.112226</td><td>13.0</td><td>2.827174</td><td>0.399835</td><td>0.858574</td><td>1.316082</td><td>259.272235</td><td>80.58671793298352,-69.46985456572693</td><td>80.58677299330257,-69.46994495614544</td><td>80.58766298671831,-69.46978376136418</td><td>80.58771805083646,-69.46987415148439</td></tr>
<tr><td>705</td><td>697.6226</td><td>1152.8283</td><td>80.59388356007929,-69.46935941852239</td><td>5.917846e-08</td><td>4.475954e-09</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>False</td><td>nan</td><td>nan</td><td>682</td><td>20.605379</td><td>1.018566e-06</td><td>1.809988e-07</td><td>23.880027</td><td>0.177586</td><td>19.496047</td><td>0.177586</td><td>5.0</td><td>0.991346</td><td>0.370467</td><td>0.626299</td><td>-4.409761</td><td>253.546391</td><td>80.59367681886094,-69.46933306820122</td><td>80.59373190715328,-69.46942345642286</td><td>80.59410636863056,-69.46930086789979</td><td>80.59416145864951,-69.46939125598577</td></tr>
</table></div></div></div>
</div>
</section>
<section id="mark-the-extended-and-point-sources-on-the-image">
<h3>Mark the extended and point sources on the image<a class="headerlink" href="#mark-the-extended-and-point-sources-on-the-image" title="Link to this heading">#</a></h3>
<p>Display combined image with point sources marked with red dots and extended sources marked with blue triangles. You will see that there are a grouping of sources near the top edge of the MIRI image, several of which may be spurious sources, which tend to be found near image edges.</p>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">doviz</span><span class="p">:</span>
    <span class="c1"># Look at mosaic data and sources found with source_catalog</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Set up image</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">miri_mosaic</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">display_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="n">display_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">miri_x</span><span class="p">,</span> <span class="n">miri_y</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># overplot point source positions</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ext_x</span><span class="p">,</span> <span class="n">ext_y</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>  <span class="c1"># overplot extended source positions</span>

    <span class="c1"># Set up colorbar</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;MJy/str&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="c1"># Set labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Final MIRI mosaic&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f9d324b0150&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f9d3190c810&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;MJy/str&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;X&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Y&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Final MIRI mosaic&#39;)
</pre></div>
</div>
<img alt="../../../_images/87e0303be533679cc1782adc2957723e938036d19015b98e3facd26de32fc100.png" src="../../../_images/87e0303be533679cc1782adc2957723e938036d19015b98e3facd26de32fc100.png" />
</div>
</div>
<hr style="border:1px solid gray"> </hr><a class="reference internal image-reference" href="https://github.com/spacetelescope/jwst-pipeline-notebooks/raw/main/_static/stsci_footer.png"><img alt="stsci_logo" src="https://github.com/spacetelescope/jwst-pipeline-notebooks/raw/main/_static/stsci_footer.png" style="width: 200px;" />
</a>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/jwst-pipeline-notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/MIRI/Imaging"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Coronagraphy/JWPipeNB-MIRI-Coron.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">MIRI Conagraphy Pipeline Notebook</p>
      </div>
    </a>
    <a class="right-next"
       href="../Imaging-TSO/JWPipeNB-MIRI-imaging-TSO.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MIRI Imaging TSO Pipeline Notebook</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration">1. Configuration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-dependencies-and-parameters">Install dependencies and parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-crds-context-and-server">Set CRDS context and server</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">2. Package Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo-mode-setup-ignore-if-not-using-demo-data">3. Demo Mode Setup (ignore if not using demo data)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-setup">4. Directory Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detector1-pipeline">5. Detector1 Pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-science-files">Calibrating Science Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-background-files">Calibrating Background Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-the-data">Exploring the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image2-pipeline">6. Image2 Pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-which-pipeline-steps-were-run-and-reference-files-used">Verify which pipeline steps were run and reference files used</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image3-pipeline">7. Image3 Pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-association-file">Create Association File</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-image3-stage-of-the-pipeline">Run Image3 stage of the pipeline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Verify which pipeline steps were run and reference files used</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-drizzle-combined-image">8. Visualize the drizzle-combined image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-detected-sources"><a id="detections">Visualize Detected Sources</a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-catalog-file-and-identify-point-extended-sources">Read in catalog file and identify point/extended sources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mark-the-extended-and-point-sources-on-the-image">Mark the extended and point sources on the image</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>